d<-read.csv("Exp.Individs.csv", sep=",", header=TRUE)
d$Species<- substr(d$ID, 1, 6)
d$Site <- substr(d$ID, 10, 11)
d$Number <- substr(d$New.ID, 9, 10)
acepen<- d %>%
dplyr::select(ID, New.ID, Species, Site,Number) %>%
filter(Species == "ACEPEN") %>%
transform(New.ID = sample(New.ID))
alninc<- d %>%
dplyr::select(ID,New.ID, Species, Site,Number) %>%
filter(Species == "ALNINC") %>%
transform(New.ID = sample(New.ID))
betall<- d %>%
dplyr::select(ID,New.ID, Species, Site,Number) %>%
filter(Species == "BETALL") %>%
transform(New.ID = sample(New.ID))
betpop<- d %>%
dplyr::select(ID,New.ID, Species, Site,Number) %>%
filter(Species == "BETPOP") %>%
transform(New.ID = sample(New.ID))
corcor<- d %>%
dplyr::select(ID,New.ID, Species, Site,Number) %>%
filter(Species == "CORCOR") %>%
transform(New.ID = sample(New.ID))
prupen<- d %>%
dplyr::select(ID,New.ID, Species, Site,Number) %>%
filter(Species == "PRUPEN") %>%
transform(New.ID = sample(New.ID))
vibcas<- d %>%
dplyr::select(ID,New.ID, Species, Site,Number) %>%
filter(Species == "VIBCAS") %>%
transform(New.ID = sample(New.ID))
df2<- rbind(acepen,alninc,betall,betpop,corcor,prupen,vibcas)
substr(df2$New.ID, 9, 10) <- df2$Number
View(df2)
setwd("~/Documents/git/springfreeze/input")
d<-read.csv("Exp.Individs.csv", sep=",", header=TRUE)
d$Species<- substr(d$ID, 1, 6)
d$Site <- substr(d$ID, 10, 11)
d$Number <- substr(d$New.ID, 9, 10)
acepen<- d %>%
dplyr::select(ID, New.ID, Species, Site,Number) %>%
filter(Species == "ACEPEN") %>%
transform(ID = sample(ID))
alninc<- d %>%
dplyr::select(ID,New.ID, Species, Site,Number) %>%
filter(Species == "ALNINC") %>%
transform(ID = sample(ID))
betall<- d %>%
dplyr::select(ID,New.ID, Species, Site,Number) %>%
filter(Species == "BETALL") %>%
transform(ID = sample(ID))
betpop<- d %>%
dplyr::select(ID,New.ID, Species, Site,Number) %>%
filter(Species == "BETPOP") %>%
transform(ID = sample(ID))
corcor<- d %>%
dplyr::select(ID,New.ID, Species, Site,Number) %>%
filter(Species == "CORCOR") %>%
transform(ID = sample(ID))
prupen<- d %>%
dplyr::select(ID,New.ID, Species, Site,Number) %>%
filter(Species == "PRUPEN") %>%
transform(ID = sample(ID))
vibcas<- d %>%
dplyr::select(ID,New.ID, Species, Site,Number) %>%
filter(Species == "VIBCAS") %>%
transform(ID = sample(ID))
df2<- rbind(acepen,alninc,betall,betpop,corcor,prupen,vibcas)
View(df2)
df2<- df2 %>%
unite(New, Species, Number)
View(df2)
df2<-site<- substr(df2$ID, 10, 11)
df2$Tag<- df2 %>%
unite(Tag, New, site)
df2$Tag<- unite(Tag, New, site)
df2$Tag<- unite(New, site)
df2<- rbind(acepen,alninc,betall,betpop,corcor,prupen,vibcas)
df2<- df2 %>%
unite(New, Species, Number)
df2<-site<- substr(df2$ID, 10, 11)
df2$Tag<- unite(New, site)
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(lubridate)
library(arm)
# Set Working Directory
setwd("~/Documents/git/springfreeze")
timeline<-read.csv("input/Budburst.DF.csv",header=TRUE)
# Convert to Julian day
timeline$DOY<-yday(timeline$Date)
phases<-c("4","7")
tx<-c("WL2", "WL0", "CS2","WL1","CS1") # may want to use WL1 instead?
timeline<-timeline %>%
dplyr::select(id, sp, site, tleaf, DOY, treatcode) %>%
filter(treatcode %in% tx) %>%
filter(tleaf %in% phases)
timeline$tleaf<- factor(timeline$tleaf, levels = c(4,7),
labels = c("Budburst","Leaves"))
hf<- timeline%>%
filter(site == "HF") %>%
group_by(sp, id, tleaf)%>%
arrange(id)%>%
filter(row_number()==1) %>%
spread(tleaf, DOY)
hf<-na.omit(hf)
hf$Risk <- hf$Leaves - hf$Budburst
hf<-filter(hf, Risk > 0)
hf.buds <- hf %>%
filter(treatcode == "CS2") %>%
dplyr::select(sp,id,Budburst) %>%
group_by(sp) %>%
summarise_each(funs(mean), Budburst)
hf.leaves <- hf %>%
filter(treatcode == "CS2") %>%
dplyr::select(sp,id,Leaves) %>%
group_by(sp) %>%
summarise_each(funs(mean), Leaves)
hf.Risk <- hf %>%
filter(treatcode == "CS2") %>%
dplyr::select(sp,id,Risk) %>%
group_by(sp) %>%
summarise_each(funs(mean), Risk)
cold<-full_join(hf.buds, hf.leaves)
cold<-full_join(cold, hf.Risk)
cold$tx<-"CS2"
cs1.buds <- hf %>%
filter(treatcode == "CS1") %>%
dplyr::select(sp,id,Budburst) %>%
group_by(sp) %>%
summarise_each(funs(mean), Budburst)
cs1.leaves <- hf %>%
filter(treatcode == "CS1") %>%
dplyr::select(sp,id,Leaves) %>%
group_by(sp) %>%
summarise_each(funs(mean), Leaves)
cs1.Risk <- hf %>%
filter(treatcode == "CS1") %>%
dplyr::select(sp,id,Risk) %>%
group_by(sp) %>%
summarise_each(funs(mean), Risk)
cs1<-full_join(cs1.buds, cs1.leaves)
cs1<-full_join(cs1, cs1.Risk)
cs1$tx<-"CS1"
#cs0.buds <- hf %>%
#filter(treatcode == "CS0") %>%
#dplyr::select(sp,id,Budburst) %>%
#group_by(sp) %>%
#summarise_each(funs(mean), Budburst)
#cs0.leaves <- hf %>%
#filter(treatcode == "CS0") %>%
#dplyr::select(sp,id,Leaves) %>%
#group_by(sp) %>%
#summarise_each(funs(mean), Leaves)
#cs0.Risk <- hf %>%
#filter(treatcode == "CS0") %>%
#dplyr::select(sp,id,Risk) %>%
#group_by(sp) %>%
#summarise_each(funs(mean), Risk)
#cs0<-full_join(cs0.buds, cs0.leaves)
#cs0<-full_join(cs0, cs0.Risk)
#cs0$tx<-"CS0"
warm.buds <- hf %>%
filter(treatcode == "WL2") %>%
dplyr::select(sp,id,Budburst) %>%
group_by(sp) %>%
summarise_each(funs(mean), Budburst)
warm.leaves <- hf %>%
filter(treatcode == "WL2") %>%
dplyr::select(sp,id,Leaves) %>%
group_by(sp) %>%
summarise_each(funs(mean), Leaves)
warm.Risk <- hf %>%
filter(treatcode == "WL2") %>%
dplyr::select(sp,id,Risk) %>%
group_by(sp) %>%
summarise_each(funs(mean), Risk)
warm<-full_join(warm.buds, warm.leaves)
warm<-full_join(warm, warm.Risk)
warm$tx<-"WL2"
med.buds <- hf %>%
filter(treatcode == "WL1") %>%
dplyr::select(sp,id,Budburst) %>%
group_by(sp) %>%
summarise_each(funs(mean), Budburst)
med.leaves <- hf %>%
filter(treatcode == "WL1") %>%
dplyr::select(sp,id,Leaves) %>%
group_by(sp) %>%
summarise_each(funs(mean), Leaves)
med.Risk <- hf %>%
filter(treatcode == "WL1") %>%
dplyr::select(sp,id,Risk) %>%
group_by(sp) %>%
summarise_each(funs(mean), Risk)
med<-full_join(med.buds, med.leaves)
med<-full_join(med, med.Risk)
med$tx<-"WL1"
wlo.buds <- hf %>%
filter(treatcode == "WL0") %>%
dplyr::select(sp,id,Budburst) %>%
group_by(sp) %>%
summarise_each(funs(mean), Budburst)
wlo.leaves <- hf %>%
filter(treatcode == "WL0") %>%
dplyr::select(sp,id,Leaves) %>%
group_by(sp) %>%
summarise_each(funs(mean), Leaves)
wlo.Risk <- hf %>%
filter(treatcode == "WL0") %>%
dplyr::select(sp,id,Risk) %>%
group_by(sp) %>%
summarise_each(funs(mean), Risk)
wlo<-full_join(wlo.buds, wlo.leaves)
wlo<-full_join(wlo, wlo.Risk)
wlo$tx<-"WL0"
hf<-bind_rows(warm,cold,med,wlo,cs1)
species<-c("ACERUB", "BETPAP", "ILEMUC", "POPGRA", "QUERUB")
hf<- hf %>%
group_by(sp,tx) %>%
filter(sp %in% species)
sp.code<-hf %>%
unite(sp.code, sp, tx)
sp.code$tx<- substr(sp.code$sp.code, 8, 10)
hf.plot<-ggplot((sp.code), aes(x=Budburst, y=sp.code), stat="identity") + geom_point(aes(x= hf$Budburst)) +
geom_segment(aes(y = sp.code, yend = sp.code, x = Budburst, xend = Leaves, col=tx)) +
geom_point(aes(x=Leaves, col=tx)) + geom_point(aes(col=tx)) +
xlab("Budburst to Leaf Out") +
ylab("Species")
plot(hf.plot)
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(lubridate)
library(arm)
# Set Working Directory
setwd("~/Documents/git/springfreeze")
timeline<-read.csv("input/hf003-06-mean-spp.csv", header=TRUE)
# Add Risk and only Two Years
years<-c("2010", "2014")
timeline<-timeline %>%
dplyr::select(year, species, bb.jd, l75.jd) %>%
filter(year%in%years)
timeline<-na.omit(timeline)
timeline$risk <- timeline$l75.jd - timeline$bb.jd
df<- timeline %>%
unite(sp.year, species, year, remove=FALSE)
df$si[df$year=="2010"] <- "early"
df$si[df$year=="2014"] <- "late"
#df<-na.omit(df)
# Make a graph!
#df$code <- reorder(df$sp.year, df$bb.jd)
df.plot<-ggplot((df), aes(x=bb.jd, y=sp.year), stat="identity") + geom_point(aes(x= df$bb.jd)) +
geom_segment(aes(y = sp.year, yend = sp.year, x = bb.jd, xend = l75.jd, col=si)) +
geom_point(aes(x=l75.jd, col=si)) + geom_point(aes(col=si)) +
xlab("Budburst to Leaf Out") +
ylab("Species")
plot(df.plot)
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(arm)
# Set Working Directory
setwd("~/Documents/git/springfreeze")
phenology<-read.csv("input/treespotters.timeline.csv",header=TRUE)
phases<-c("Budburst","Leaves")
pheno<-phenology%>%
dplyr::select(Site_ID, Genus, Species, Individual_ID, Phenophase_Description, First_Yes_DOY, First_Yes_Year, Latitude, Longitude) %>%
unite(species, Genus, Species, sep="_") %>%
filter(Phenophase_Description %in% phases) %>%
rename(Year = First_Yes_Year)
# Make dataframe that includes Risk for each species
y0<-pheno%>%
filter(Year=="2015")%>%
group_by(species, Individual_ID, Phenophase_Description)%>%
arrange(Individual_ID) %>%
filter(row_number()==1) %>%
spread(Phenophase_Description, First_Yes_DOY)
y0<-na.omit(y0)
y0$Risk <- y0$Leaves - y0$Budburst
y0<-filter(y0, Risk > 0)
y0<-filter(y0, Risk < 31)
y1<-pheno%>%
filter(Year=="2016")%>%
group_by(species, Individual_ID, Phenophase_Description)%>%
arrange(Individual_ID) %>%
filter(row_number()==1) %>%
spread(Phenophase_Description, First_Yes_DOY)
y1<-na.omit(y1)
y1$Risk <- y1$Leaves - y1$Budburst
y1<-filter(y1, Risk > 0)
y1<-filter(y1, Risk < 31)
dat<-full_join(y0,y1)
bud<- y1 %>%
dplyr::select(species, Budburst) %>%
group_by(species)%>%
summarise_each(funs(mean), Budburst) %>%
arrange(species)
leaves<- y1 %>%
dplyr::select(species, Leaves) %>%
group_by(species)%>%
summarise_each(funs(mean), Leaves) %>%
arrange(species)
basic<- full_join(bud, leaves)
basic$Risk<- basic$Leaves - basic$Budburst
basic$code <- reorder(basic$species, basic$Budburst)
ts.timeline<-ggplot((basic), aes(x=Budburst, y=code), stat="identity") + geom_point(aes(x= basic$Budburst)) +
geom_segment(aes(y = species, yend = species, x = Budburst, xend = Leaves)) +
geom_point(aes(x=basic$Leaves)) + theme(legend.position="none") + geom_point(aes(col=species)) + xlab("Budburst to Leaf Out") +
ylab("Species")
plot(ts.timeline)
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
# Integrate Phenology Data and compare methodologies
# Set Working Directory
setwd("~/Documents/git/springfreeze/input")
budburst<-read.csv("hf003-06-mean-spp.csv",header=TRUE, sep=",")
budburst<-filter(budburst, year>2000)
sp <- budburst %>%
dplyr::select(year, species, bb.jd) %>%
arrange(bb.jd) %>%
group_by(species, year)%>%
arrange(year)
df<-as.data.frame(table(budburst$species))
spp<- c("PRSE", "AMSP", "POTR", "CRSP", "HAVI", "ACSA", "BEPA", "ACPE", "ACRU", "QURU",
"BEAL", "BELE") ## Species that were observed each year
sp.short<- c("ACPE","ACRU","ACSA","FAGR","FRAM","HAVI","QUAL",
"QURU","PRSE", "AMSP", "POTR", "CRSP","BEPA",
"BEAL", "BELE", "COAL", "QUVE")
d <- budburst %>%
dplyr::select(year, species, bb.jd)%>%
filter(species %in% sp.short)
df<- d %>%
dplyr::select(species, bb.jd) %>%
arrange(bb.jd)
obs_bb.avg<- d %>%
dplyr::select(year,bb.jd)%>%
group_by(year)%>%
summarise_each(funs(mean), bb.jd) %>%
rename(mean=bb.jd)%>%
arrange(year)
obs_bb.sd<- d %>%
group_by(year)%>%
summarise_each(funs(sd), bb.jd) %>%
rename(sd=bb.jd)%>%
arrange(year)
obs_bb<- obs_bb.avg%>%
right_join(obs_bb.sd,obs_bb.avg,by="year")%>%
arrange(year)
compare<- read.csv("method.test.csv", header=TRUE, sep=",")
attach(compare)
#obs.npn<- obs_bb %>%
##full_join(compare) %>%
#dplyr::select(year, bb.jd, bb_npn)%>%
#arrange(year) %>%
#filter(year>=1990) %>%
#filter(year<2015)
## Species that are more comparable to lilacs and honeysuckle ##
sm.sp<- c("PRSE", "POTR", "AMSP", "CRSP", "HAVI", "ACSA", "BEPA", "ACPE")
small<- budburst%>%
dplyr::select(year, species, bb.jd) %>%
filter(species %in% sm.sp)
condensed<- small %>%
group_by(year)%>%
summarise_each(funs(mean),bb.jd)%>%
arrange(year)
sm.comp<- condensed %>%
full_join(compare) %>%
dplyr::select(year, bb.jd, bb_npn, last_frz) %>%
arrange(year) %>%
filter(year>=1990) %>%
filter(year<2015)
# Compares FSI values for small dataset of Dr O'Keefe's observational
# data and USNPN Spring Indices, based on -1.7 deg Celcius last freeze
method<-read.csv("method.test.csv",header=TRUE,sep=",")
#attach(method)
bb.table<-method %>%
dplyr::select(year,last_frz,bb_npn, sm.bb) %>%
filter(year>=2008)%>%
filter(year<2015)%>%
rename("Last Freeze"=last_frz)%>%
rename("Observed"=sm.bb)%>%
rename("SI-x"=bb_npn)
FSI.table<- method %>%
dplyr::select(year, FSI_npn, FSI_okeefe, FSI_cam) %>%
rename(okeefe = FSI_okeefe)%>%
rename(phenocam = FSI_cam) %>%
rename(npn = FSI_npn) %>%
filter(year>=2008) %>%
filter(year<2015)
bb.long<- method%>%
dplyr::select(year,bb_npn,sm.bb, bb_obs, bb_cam)%>%
filter(year>=2001)%>%
filter(year<2015)
blend<-FSI.table %>%
gather(Method, FSI, -year) %>%
arrange(year)
blend.long<-FSI.long%>%
gather(Method,FSI,-year)%>%
arrange(year)
ggplot(blend, (aes(Method, FSI)), xlab="Method", ylab="FSI") +
geom_boxplot(fill=c("#F8766D","#00C094","#00B6EB","#A58AFF"))
boxplot(data=blend, FSI~Method, xlab="Method", ylab="FSI")
boxplot(data=blend.long, FSI~Method)
methodplot<-ggplot(blend, aes(year, FSI)) + xlab("Year") +
ylab("False Spring Index") + scale_x_continuous(limits = c(2008,2014),breaks=seq(2008,2014,1)) +
geom_point(aes(col=Method)) + scale_color_manual(values=c("#F8766D","#00C094","#00B6EB","#A58AFF")) +
geom_line(aes(x=year, y=FSI, col=Method))
plot(methodplot)
df2$Tag<- unite(df2, New, site)
library(dplyr)
library(tidyr)
rm(list=ls())
options(stringsAsFactors = FALSE)
# Set own wd as needed
setwd("~/Documents/git/springfreeze/input")
d<-read.csv("Exp.Individs.csv", sep=",", header=TRUE)
d$Species<- substr(d$ID, 1, 6)
d$Site <- substr(d$ID, 10, 11)
d$Number <- substr(d$New.ID, 9, 10)
acepen<- d %>%
dplyr::select(ID, New.ID, Species, Site,Number) %>%
filter(Species == "ACEPEN") %>%
transform(ID = sample(ID))
alninc<- d %>%
dplyr::select(ID,New.ID, Species, Site,Number) %>%
filter(Species == "ALNINC") %>%
transform(ID = sample(ID))
betall<- d %>%
dplyr::select(ID,New.ID, Species, Site,Number) %>%
filter(Species == "BETALL") %>%
transform(ID = sample(ID))
betpop<- d %>%
dplyr::select(ID,New.ID, Species, Site,Number) %>%
filter(Species == "BETPOP") %>%
transform(ID = sample(ID))
corcor<- d %>%
dplyr::select(ID,New.ID, Species, Site,Number) %>%
filter(Species == "CORCOR") %>%
transform(ID = sample(ID))
prupen<- d %>%
dplyr::select(ID,New.ID, Species, Site,Number) %>%
filter(Species == "PRUPEN") %>%
transform(ID = sample(ID))
vibcas<- d %>%
dplyr::select(ID,New.ID, Species, Site,Number) %>%
filter(Species == "VIBCAS") %>%
transform(ID = sample(ID))
df2<- rbind(acepen,alninc,betall,betpop,corcor,prupen,vibcas)
df2<- df2 %>%
unite(New, Species, Number)
df2<-site<- substr(df2$ID, 10, 11)
df2$Tag<- unite(df2, New, site)
substr(df2$New.ID, 9, 10) <- df2$Number
df2<- rbind(acepen,alninc,betall,betpop,corcor,prupen,vibcas)
df2<- df2 %>%
unite(New, Species, Number)
df2<-site<- substr(df2$ID, 10, 11)
substr(df2$New.ID, 9, 10) <- df2$Number
df2$site<- substr(df2$ID, 10, 11)
df2<- rbind(acepen,alninc,betall,betpop,corcor,prupen,vibcas)
df2<- df2 %>%
unite(New, Species, Number)
df2$site<- substr(df2$ID, 10, 11)
df2$Tag<- unite(df2, New, site)
View(df2)
df2<- rbind(acepen,alninc,betall,betpop,corcor,prupen,vibcas)
df2<- df2 %>%
unite(New, Species, Number)
df2$site<- substr(df2$ID, 10, 11)
View(df2)
df2$Tag<- df2 %>%
dplyr::select(-Site) %>%
unite(New, site)
View(df2)
df3<- df2 %>%
dplyr::select(-Site)
df2<- rbind(acepen,alninc,betall,betpop,corcor,prupen,vibcas)
df2<- df2 %>%
unite(New, Species, Number)
df2$site<- substr(df2$ID, 10, 11)
df3<- df2 %>%
dplyr::select(-Site)
df3$Tag<-unite(New, site)
View(df3)
df3$Tag<-unite(df3, New, site)
View(df3)
df3<-df3%>%
select(ID,New,site)
df3<-df3%>%
dplyr::select(ID,New,site)
View(df3)
write.csv(df3,"~/Documents/git/springfreeze/output/new.tags.csv",row.names=FALSE, eol="\r\n") #Added by Cat
