nc.count<-full_join(nc.count, nc.high)
nc.count<-full_join(nc.count, nc.low)
nc2<-nc.count %>%
ungroup(nc.count) %>%
dplyr::select(-count, -year)
nc2<-nc2%>% filter (! duplicated(biweekly))
nc2$site<-"North Carolina"
nc.count$site<-"North Carolina"
# Lyon, France: Apr 5 - May 10
ren<-france %>%
dplyr::select(STATION_NAME,DATE, TAVG, TMIN, TMAX) %>%
filter(STATION_NAME == "BRON LYON AEROPORT FR") %>%
rename(Tmin = TMIN) %>%
rename(Tmax = TMAX) %>%
rename(date = DATE)
ren$year <- substr(ren$date, 0, 4)
ren<- ren %>%
filter(year>=1965) %>%
filter(year<2016)
ren$month<- substr(ren$date, 5, 6)
ren$day<- substr(ren$date, 7,8)
ren<- ren %>%
dplyr::select(-date)%>%
unite(date, year, month, day, sep="-") %>%
dplyr::select(date,Tmin, Tmax)
ren$doy<-yday(ren$date)
ren$year<-substr(ren$date,0,4)
ren$month<-substr(ren$date, 6,7)
ren$day<-substr(ren$date,9,10)
ren$biweek<-ifelse(ren$day<=15,1,2)
ren<-ren%>%unite(biweekly,month,biweek, sep="_")
ren$Tmean <- (ren$Tmax + ren$Tmin)/2
ren$gdd <- ren$Tmean - 5
ren$gdd <-ifelse(ren$gdd>0, ren$gdd, 0)
ren$frz<- ifelse((ren$Tmin<=-2.2), 1, 0)
ren$count <- ave(
ren$frz, ren$biweekly, ren$year,
FUN=function(x) cumsum(c(0, head(x, -1)))
)
ren<- ren %>%
filter(doy >= 95) %>%
filter(doy <= 130)
ren.count<- ren %>%
dplyr::select(year,biweekly, count) %>%
group_by(year, biweekly)%>%
filter(row_number(biweekly)==n())
ren.count$mean<-ave(ren.count$count, ren.count$biweekly)
ren.count$stand_dev<-ave(ren.count$count, ren.count$biweekly, FUN=sd)
ren.high<-ren.count%>%group_by(biweekly)%>%summarise(high=max(count))%>%ungroup(ren.count)
ren.low<-ren.count%>%group_by(biweekly)%>%summarise(low=min(count))%>%ungroup(ren.count)
ren.count<-full_join(ren.count, ren.high)
ren.count<-full_join(ren.count, ren.low)
ren1<-ren.count %>%
ungroup(ren.count) %>%
dplyr::select(-count, -year)
ren1<-ren1%>% filter (! duplicated(biweekly))
ren1$site<-"France"
ren.count$site<-"France"
d<-full_join(gm, wash)
d<-full_join(d, nc2)
d<-full_join(d, ren1)
d<-full_join(d, maine)
df<-full_join(gm.count,wash.count)
df<-full_join(df, nc.count)
df<-full_join(df, ren.count)
df<-full_join(df, water.count)
limits <- aes(ymax = mean + stand_dev, ymin=mean - stand_dev)
d$biweekly<-ifelse(d$biweekly=="02_2", "Feb 15 - Feb 29", d$biweekly)
d$biweekly<-ifelse(d$biweekly=="03_1", "Mar 1 - Mar 14", d$biweekly)
d$biweekly<-ifelse(d$biweekly=="03_2", "Mar 15 - Mar 31", d$biweekly)
d$biweekly<-ifelse(d$biweekly=="04_1", "Apr 1 - Apr 14", d$biweekly)
d$biweekly<-ifelse(d$biweekly=="04_2", "Apr 15 - Apr 30", d$biweekly)
d$biweekly<-ifelse(d$biweekly=="05_1", "May 1 - May 14", d$biweekly)
d$biweekly<-ifelse(d$biweekly=="05_2", "May 15 - May 31", d$biweekly)
d$high<-as.numeric(as.character(d$high))
d$low<-as.numeric(as.character(d$low))
d$biweekly <- factor(d$biweekly, levels=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30","May 1 - May 14","May 15 - May 31"))
limitcolor<-c("lightgoldenrod", "lightgoldenrod", "lightgoldenrod","plum", "plum", "plum",
"lightblue", "lightblue", "lightblue", "lightblue",
"pink", "pink", "pink", "mediumaquamarine", "mediumaquamarine", "mediumaquamarine", "mediumaquamarine")
ggplot((d), aes(x=biweekly, y=mean, col=site)) + geom_point() + xlab("Two Week Period") + ylab("Average Number of days per two week period below -2.2C") +
geom_line(aes(x=biweekly, y=mean, col=site, group=site)) + geom_linerange(limits, col=limitcolor)
risk<-ggplot(d, aes(x=biweekly, y=mean, color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")))) +
geom_point() + xlab("Two Week Period") + ylab("Number of days below -2.2C per two week period") +
geom_line(aes(x=biweekly, y=mean,  color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")), group=site)) +
geom_linerange(aes(ymax = d$high, ymin=d$low), stat="density", position=position_dodge(.2), alpha=0.3, size=2) + labs(color="Location and Day of Budburst Range") +
theme(panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), legend.position=c(0.8,0.91),
legend.key.size=unit(0.3, "cm"))
## Make a dataframe:
x<- data.frame("Site"=c( "France", "Germany", "Maine", "North Carolina","Washington"), "Earliest"=c( 90,90, 100, 50, 80),
"Early" = c( 100, 112, 115, 80,115), "Late" = c( 115, 127, 120, 90, 120), "Latest" = c( 120,140, 150, 100, 130))
fix<-x%>%
gather("time", "doy", Earliest, Early, Late, Latest) %>%
arrange(desc(Site))
fix$biweekly<-ifelse((fix$doy>=46 & fix$doy <=60), "Feb 15 - Feb 29", fix$doy)
fix$biweekly<-ifelse((fix$doy>=61 & fix$doy <=73), "Mar 1 - Mar 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=74 & fix$doy <=91), "Mar 15 - Mar 31", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=92 & fix$doy <=106), "Apr 1 - Apr 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=107 & fix$doy <=121), "Apr 15 - Apr 30", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=122 & fix$doy <=136), "May 1 - May 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=137 & fix$doy <=152), "May 15 - May 31", fix$biweekly)
fix$doy<-as.numeric(as.character(fix$doy))
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site)) + coord_flip() +
scale_y_continuous(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31")) +
theme(legend.position=c(0.1,0.15), legend.key.size=unit(0.4, "cm")) + ylab("Day of Year")
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time), size="last"))
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time), size="first"))
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site)) + coord_flip() +
scale_y_continuous(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31")) +
theme(legend.position=c(0.1,0.15), legend.key.size=unit(0.4, "cm"), panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1)) + ylab("Day of Year")
time
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31")) +
theme(legend.position=c(0.1,0.15), legend.key.size=unit(0.4, "cm"), panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1)) + ylab("Day of Year")
time
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31")) +
theme(legend.position=c(0.1,0.15), legend.key.size=unit(0.4, "cm"), panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1)) +
ylab("Day of Year") + scale_shape_manual(values = 0:length(unique(fix$Site)))
time
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31")) +
theme(legend.position=c(0.1,0.15), legend.key.size=unit(0.4, "cm"), panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1)) +
ylab("Day of Year") + coord_fixed(ratio = 0.2)
time
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip(ratio=0.2) +
scale_y_continuous(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31")) +
theme(legend.position=c(0.1,0.15), legend.key.size=unit(0.4, "cm"), panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1)) +
ylab("Day of Year")
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31")) +
theme(legend.position=c(0.1,0.15), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.2,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1)) +
ylab("Day of Year")
time
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31")) +
theme(legend.position=c(0.1,0.15), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.4,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1)) +
ylab("Day of Year")
time
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31")) +
theme(legend.position=c(0.1,0.2), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1)) +
ylab("Day of Year")
time
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31")) +
theme(legend.position=c(0.1,0.3), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1)) +
ylab("Day of Year")
time
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time), size="first"))
x<- data.frame("Site"=c( "France", "Germany", "Maine", "North Carolina","Washington"), "Earliest"=c( 90,90, 100, 50, 80),
"Early" = c( 100, 112, 115, 80,100), "Late" = c( 115, 127, 120, 90, 120), "Latest" = c( 120,140, 150, 100, 130))
fix<-x%>%
gather("time", "doy", Earliest, Early, Late, Latest) %>%
arrange(desc(Site))
fix$biweekly<-ifelse((fix$doy>=46 & fix$doy <=60), "Feb 15 - Feb 29", fix$doy)
fix$biweekly<-ifelse((fix$doy>=61 & fix$doy <=73), "Mar 1 - Mar 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=74 & fix$doy <=91), "Mar 15 - Mar 31", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=92 & fix$doy <=106), "Apr 1 - Apr 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=107 & fix$doy <=121), "Apr 15 - Apr 30", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=122 & fix$doy <=136), "May 1 - May 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=137 & fix$doy <=152), "May 15 - May 31", fix$biweekly)
fix$doy<-as.numeric(as.character(fix$doy))
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31")) +
theme(legend.position=c(0.1,0.3), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1)) +
ylab("Day of Year") + xlab("")
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time), size="first"))
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time))
ggplot(data = df, aes(x=biweekly, y=count)) + geom_boxplot(aes(fill=site))
df$biweekly<-ifelse(df$biweekly=="02_2", "Feb 15 - Feb 29", df$biweekly)
df$biweekly<-ifelse(df$biweekly=="03_1", "Mar 1 - Mar 14", df$biweekly)
df$biweekly<-ifelse(df$biweekly=="03_2", "Mar 15 - Mar 31", df$biweekly)
df$biweekly<-ifelse(df$biweekly=="04_1", "Apr 1 - Apr 14", df$biweekly)
df$biweekly<-ifelse(df$biweekly=="04_2", "Apr 15 - Apr 30", df$biweekly)
df$biweekly<-ifelse(df$biweekly=="05_1", "May 1 - May 14", df$biweekly)
df$biweekly<-ifelse(df$biweekly=="05_2", "May 15 - May 31", df$biweekly)
#df_table <- table(df$biweekly)
#df_levels <- names(df_table)[order(df_table)]
df$biweekly <- factor(df$biweekly, levels=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30","May 1 - May 14","May 15 - May 31"))
qplot(site, count, data = df,
geom = "boxplot", color=biweekly) +
xlab("Site")+ylab("Mean number of freeze days")
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)))
risk<-ggplot(d, aes(x=biweekly, y=mean, color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")))) +
geom_point() + xlab("Two Week Period") + ylab("Number of days below -2.2C per two week period") +
geom_line(aes(x=biweekly, y=mean,  color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")), group=site)) +
geom_linerange(aes(ymax = d$high, ymin=d$low), stat="density", position=position_dodge(.2), alpha=0.3, size=2) + labs(color="Location and Day of Budburst Range") +
theme(panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), legend.position=c(0.8,0.91),
legend.key.size=unit(0.3, "cm")) + scale_x_continuous(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"))
## Make a dataframe:
x<- data.frame("Site"=c( "France", "Germany", "Maine", "North Carolina","Washington"), "Earliest"=c( 90,90, 100, 50, 80),
"Early" = c( 100, 112, 115, 80,100), "Late" = c( 115, 127, 120, 90, 120), "Latest" = c( 120,140, 150, 100, 130))
fix<-x%>%
gather("time", "doy", Earliest, Early, Late, Latest) %>%
arrange(desc(Site))
fix$biweekly<-ifelse((fix$doy>=46 & fix$doy <=60), "Feb 15 - Feb 29", fix$doy)
fix$biweekly<-ifelse((fix$doy>=61 & fix$doy <=73), "Mar 1 - Mar 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=74 & fix$doy <=91), "Mar 15 - Mar 31", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=92 & fix$doy <=106), "Apr 1 - Apr 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=107 & fix$doy <=121), "Apr 15 - Apr 30", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=122 & fix$doy <=136), "May 1 - May 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=137 & fix$doy <=152), "May 15 - May 31", fix$biweekly)
fix$doy<-as.numeric(as.character(fix$doy))
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31")) +
theme(legend.position=c(0.1,0.3), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1)) +
ylab("Day of Year") + xlab("")
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)))
risk<-ggplot(d, aes(x=biweekly, y=mean, color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")))) +
geom_point() + xlab("Two Week Period") + ylab("Number of days below -2.2C per two week period") +
geom_line(aes(x=biweekly, y=mean,  color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")), group=site)) +
geom_linerange(aes(ymax = d$high, ymin=d$low), stat="density", position=position_dodge(.2), alpha=0.3, size=2) + labs(color="Location and Day of Budburst Range") +
theme(panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), legend.position=c(0.8,0.91),
legend.key.size=unit(0.3, "cm")) + scale_x_discrete(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"))
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)))
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"), position="top") +
theme(legend.position=c(0.1,0.3), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1)) +
ylab("Day of Year") + xlab("")
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)))
risk<-ggplot(d, aes(x=biweekly, y=mean, color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")))) +
geom_point() + xlab("") + ylab("Number of days below -2.2C per two week period") +
geom_line(aes(x=biweekly, y=mean,  color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")), group=site)) +
geom_linerange(aes(ymax = d$high, ymin=d$low), stat="density", position=position_dodge(.2), alpha=0.3, size=2) + labs(color="Location and Day of Budburst Range") +
theme(panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), legend.position=c(0.8,0.91),
legend.key.size=unit(0.3, "cm")) + scale_x_discrete(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"))
## Make a dataframe:
x<- data.frame("Site"=c( "France", "Germany", "Maine", "North Carolina","Washington"), "Earliest"=c( 90,90, 100, 50, 80),
"Early" = c( 100, 112, 115, 80,100), "Late" = c( 115, 127, 120, 90, 120), "Latest" = c( 120,140, 150, 100, 130))
fix<-x%>%
gather("time", "doy", Earliest, Early, Late, Latest) %>%
arrange(desc(Site))
fix$biweekly<-ifelse((fix$doy>=46 & fix$doy <=60), "Feb 15 - Feb 29", fix$doy)
fix$biweekly<-ifelse((fix$doy>=61 & fix$doy <=73), "Mar 1 - Mar 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=74 & fix$doy <=91), "Mar 15 - Mar 31", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=92 & fix$doy <=106), "Apr 1 - Apr 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=107 & fix$doy <=121), "Apr 15 - Apr 30", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=122 & fix$doy <=136), "May 1 - May 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=137 & fix$doy <=152), "May 15 - May 31", fix$biweekly)
fix$doy<-as.numeric(as.character(fix$doy))
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"), position="top") +
theme(legend.position=c(0.1,0.3), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1)) +
ylab("") + xlab("")
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)))
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(55, 70, 88, 101, 117, 133, 148), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"), position="top") +
theme(legend.position=c(0.1,0.3), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1)) +
ylab("") + xlab("")
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)))
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(55, 70, 85, 101, 116, 132, 147), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"), position="top") +
theme(legend.position=c(0.1,0.3), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1)) +
ylab("") + xlab("")
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)))
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)), width=0.2)
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(55, 70, 85, 101, 116, 131, 146), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"), position="top") +
theme(legend.position=c(0.1,0.3), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), plot.margin=unit(c(.2,1,.1,1),"cm"))) +
ylab("") + xlab("")
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(55, 70, 85, 101, 116, 131, 146), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"), position="top") +
theme(legend.position=c(0.1,0.3), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), plot.margin=unit(c(.2,1,.1,1),"cm"))) +
ylab("") + xlab("")
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(55, 70, 85, 101, 116, 131, 146), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"), position="top") +
theme(legend.position=c(0.1,0.3), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), plot.margin=unit(c(.2,1,.1,1),"cm")) +
ylab("") + xlab("")
time
risk<-ggplot(d, aes(x=biweekly, y=mean, color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")))) +
geom_point() + xlab("") + ylab("Number of days below -2.2C per two week period") +
geom_line(aes(x=biweekly, y=mean,  color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")), group=site)) +
geom_linerange(aes(ymax = d$high, ymin=d$low), stat="density", position=position_dodge(.2), alpha=0.3, size=2) + labs(color="Location and Day of Budburst Range") +
theme(panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), legend.position=c(0.8,0.91),
legend.key.size=unit(0.3, "cm"), plot.margin=unit(c(.2,1,.1,1),"cm")) +
scale_x_discrete(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"))
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)))
risk<-ggplot(d, aes(x=biweekly, y=mean, color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")))) +
geom_point() + xlab("") + ylab("Number of days below -2.2C per two week period") +
geom_line(aes(x=biweekly, y=mean,  color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")), group=site)) +
geom_linerange(aes(ymax = d$high, ymin=d$low), stat="density", position=position_dodge(.2), alpha=0.3, size=2) + labs(color="Location and Day of Budburst Range") +
theme(panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), legend.position=c(0.8,0.91),
legend.key.size=unit(0.3, "cm"), plot.margin=unit(c(.2,.1,.1,.1),"cm")) +
scale_x_discrete(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"))
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(55, 70, 85, 101, 116, 131, 146), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"), position="top") +
theme(legend.position=c(0.1,0.3), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), plot.margin=unit(c(.2,.1,.1,.1),"cm")) +
ylab("") + xlab("")
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)))
risk<-ggplot(d, aes(x=biweekly, y=mean, color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")))) +
geom_point() + xlab("") + ylab("Number of days below -2.2C per two week period") +
geom_line(aes(x=biweekly, y=mean,  color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")), group=site)) +
geom_linerange(aes(ymax = d$high, ymin=d$low), stat="density", position=position_dodge(.2), alpha=0.3, size=2) + labs(color="Location and Day of Budburst Range") +
theme(panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), legend.position=c(0.8,0.91),
legend.key.size=unit(0.3, "cm"), plot.margin=unit(c(.05,.5,.1,.5),"cm")) +
scale_x_discrete(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"))
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(55, 70, 85, 101, 116, 131, 146), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"), position="top") +
theme(legend.position=c(0.1,0.3), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), plot.margin=unit(c(.05,.5,.1,.5),"cm")) +
ylab("") + xlab("")
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)))
risk<-ggplot(d, aes(x=biweekly, y=mean, color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")))) +
geom_point() + xlab("") + ylab("Number of days below -2.2C per two week period") +
geom_line(aes(x=biweekly, y=mean,  color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")), group=site)) +
geom_linerange(aes(ymax = d$high, ymin=d$low), stat="density", position=position_dodge(.2), alpha=0.3, size=2) + labs(color="Location and Day of Budburst Range") +
theme(panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), legend.position=c(0.8,0.91),
legend.key.size=unit(0.3, "cm"), plot.margin=unit(c(.1,.5,.05,.5),"cm")) +
scale_x_discrete(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"))
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(55, 70, 85, 101, 116, 131, 146), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"), position="top") +
theme(legend.position=c(0.1,0.3), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), plot.margin=unit(c(.1,.5,.05,.5),"cm")) +
ylab("") + xlab("")
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)))
risk<-ggplot(d, aes(x=biweekly, y=mean, color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")))) +
geom_point() + xlab("") + ylab("Number of days below -2.2C per two week period") +
geom_line(aes(x=biweekly, y=mean,  color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")), group=site)) +
geom_linerange(aes(ymax = d$high, ymin=d$low), stat="density", position=position_dodge(.2), alpha=0.3, size=2) + labs(color="Location and Day of Budburst Range") +
theme(panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), legend.position=c(0.8,0.91),
legend.key.size=unit(0.3, "cm"), plot.margin=unit(c(.1,.5,.01,.5),"cm")) +
scale_x_discrete(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"))
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(55, 70, 85, 101, 116, 131, 146), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"), position="top") +
theme(legend.position=c(0.1,0.3), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), plot.margin=unit(c(.01,.5,.1,.5),"cm")) +
ylab("") + xlab("")
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)))
risk<-ggplot(d, aes(x=biweekly, y=mean, color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")))) +
geom_point() + xlab("") + ylab("Number of days below -2.2C per two week period") +
geom_line(aes(x=biweekly, y=mean,  color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")), group=site)) +
geom_linerange(aes(ymax = d$high, ymin=d$low), stat="density", position=position_dodge(.2), alpha=0.3, size=2) + labs(color="Location and Day of Budburst Range") +
theme(panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), legend.position=c(0.8,0.91),
legend.key.size=unit(0.3, "cm"), plot.margin=unit(c(.1,.5,0,.5),"cm")) +
scale_x_discrete(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"))
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(55, 70, 85, 101, 116, 131, 146), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"), position="top") +
theme(legend.position=c(0.1,0.3), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), plot.margin=unit(c(0,.5,.1,.5),"cm")) +
ylab("") + xlab("")
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)))
risk<-ggplot(d, aes(x=biweekly, y=mean, color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")))) +
geom_point() + xlab("") + ylab("Number of days below -2.2C per two week period") +
geom_line(aes(x=biweekly, y=mean,  color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")), group=site)) +
geom_linerange(aes(ymax = d$high, ymin=d$low), stat="density", position=position_dodge(.2), alpha=0.3, size=2) + labs(color="Location and Day of Budburst Range") +
theme(panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), legend.position=c(0.8,0.91),
legend.key.size=unit(0.3, "cm"), plot.margin=unit(c(.1,.5,-.1,.5),"cm")) +
scale_x_discrete(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"))
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(55, 70, 85, 101, 116, 131, 146), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"), position="top") +
theme(legend.position=c(0.1,0.3), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), plot.margin=unit(c(-.1,.5,.1,.5),"cm")) +
ylab("") + xlab("")
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)))
risk<-ggplot(d, aes(x=biweekly, y=mean, color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")))) +
geom_point() + xlab("") + ylab("Number of days below -2.2C per two week period") +
geom_line(aes(x=biweekly, y=mean,  color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")), group=site)) +
geom_linerange(aes(ymax = d$high, ymin=d$low), stat="density", position=position_dodge(.2), alpha=0.3, size=2) + labs(color="Location and Day of Budburst Range") +
theme(panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), legend.position=c(0.8,0.91),
legend.key.size=unit(0.3, "cm"), plot.margin=unit(c(.1,.5,-.2,.5),"cm")) +
scale_x_discrete(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"))
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(55, 70, 85, 101, 116, 131, 146), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"), position="top") +
theme(legend.position=c(0.1,0.3), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), plot.margin=unit(c(-.2,.5,.1,.5),"cm")) +
ylab("") + xlab("")
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)))
risk<-ggplot(d, aes(x=biweekly, y=mean, color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")))) +
geom_point() + xlab("") + ylab("Number of days below -2.2C per two week period") +
geom_line(aes(x=biweekly, y=mean,  color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")), group=site)) +
geom_linerange(aes(ymax = d$high, ymin=d$low), stat="density", position=position_dodge(.2), alpha=0.3, size=2) + labs(color="Location and Day of Budburst Range") +
theme(panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), legend.position=c(0.8,0.91),
legend.key.size=unit(0.3, "cm"), plot.margin=unit(c(.2,.5,-.3,.5),"cm")) +
scale_x_discrete(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"))
## Make a dataframe:
x<- data.frame("Site"=c( "France", "Germany", "Maine", "North Carolina","Washington"), "Earliest"=c( 90,90, 100, 50, 80),
"Early" = c( 100, 112, 115, 80,100), "Late" = c( 115, 127, 120, 90, 120), "Latest" = c( 120,140, 150, 100, 130))
fix<-x%>%
gather("time", "doy", Earliest, Early, Late, Latest) %>%
arrange(desc(Site))
fix$biweekly<-ifelse((fix$doy>=46 & fix$doy <=60), "Feb 15 - Feb 29", fix$doy)
fix$biweekly<-ifelse((fix$doy>=61 & fix$doy <=73), "Mar 1 - Mar 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=74 & fix$doy <=91), "Mar 15 - Mar 31", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=92 & fix$doy <=106), "Apr 1 - Apr 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=107 & fix$doy <=121), "Apr 15 - Apr 30", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=122 & fix$doy <=136), "May 1 - May 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=137 & fix$doy <=152), "May 15 - May 31", fix$biweekly)
fix$doy<-as.numeric(as.character(fix$doy))
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(55, 70, 85, 101, 116, 131, 146), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"), position="top") +
theme(legend.position=c(0.1,0.3), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), plot.margin=unit(c(-.2,.5,.2,.5),"cm")) +
ylab("") + xlab("")
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)))
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(55, 70, 85, 101, 116, 131, 146), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"), position="top") +
theme(legend.position=c(0.1,0.3), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), plot.margin=unit(c(-.2,.5,.2,.5),"cm")) +
ylab("") + xlab("") + labs(caption = "A comparison of false spring risk across five climate regions. The data was subsetted for each region based on
earliest historical spring onset date to the latest historical leafout date and was divided into biweekly time periods
(Schaber and Badeck, 2005, White et al., 2009, Soudani et al., 2012, USA-NPN, 2016)")
risk<-ggplot(d, aes(x=biweekly, y=mean, color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")))) +
geom_point() + xlab("") + ylab("Number of days below -2.2C per two week period") +
geom_line(aes(x=biweekly, y=mean,  color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")), group=site)) +
geom_linerange(aes(ymax = d$high, ymin=d$low), stat="density", position=position_dodge(.2), alpha=0.3, size=2) + labs(color="Location and Day of Budburst Range") +
theme(panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), legend.position=c(0.9,0.91),
legend.key.size=unit(0.3, "cm"), plot.margin=unit(c(.2,.5,-.3,.5),"cm")) +
scale_x_discrete(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"))
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(55, 70, 85, 101, 116, 131, 146), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"), position="top") +
theme(legend.position=c(0.05,0.3), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), plot.margin=unit(c(-.2,.5,.2,.5),"cm")) +
ylab("") + xlab("")
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)))
risk<-ggplot(d, aes(x=biweekly, y=mean, color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")))) +
geom_point() + xlab("") + ylab("Number of days below -2.2C per two week period") +
geom_line(aes(x=biweekly, y=mean,  color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")), group=site)) +
geom_linerange(aes(ymax = d$high, ymin=d$low), stat="density", position=position_dodge(.2), alpha=0.3, size=2) + labs(color="Location and Day of Budburst Range") +
theme(panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), legend.position=c(0.88,0.91),
legend.key.size=unit(0.3, "cm"), plot.margin=unit(c(.2,.5,-.3,.5),"cm")) +
scale_x_discrete(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"))
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)))
