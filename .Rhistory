y<- df %>%
dplyr::select(species, Budburst, Leaves, Risk, mean, sd, mean.leaf, sd.leaf) %>%
gather(Phenophase, DOY, -species, -Risk, -mean, -sd, -mean.leaf, -sd.leaf)
y<-y %>%
group_by(species, mean, Phenophase)%>%
arrange(species)%>%
filter(row_number()==1)%>%
ungroup(y)
bud<- df %>%
dplyr::select(species, Budburst) %>%
group_by(species)%>%
summarise_each(funs(mean), Budburst) %>%
arrange(species)
leaves<- df %>%
dplyr::select(species, Leaves) %>%
group_by(species)%>%
summarise_each(funs(mean), Leaves) %>%
arrange(species)
sd<- y %>%
dplyr::select(species, sd, sd.leaf)
basic<- full_join(bud, leaves)
basic$Risk<- basic$Leaves - basic$Budburst
basic<-full_join(basic, sd)
basic$code <- reorder(basic$species, basic$Budburst)
ts.timeline<-ggplot((basic), aes(x=Budburst, y=code), stat="identity") + geom_point(aes(x= basic$Budburst)) +
geom_segment(aes(y = species, yend = species, x = Budburst, xend = Leaves)) +
geom_point(aes(x=basic$Leaves)) + theme(legend.position="none") + geom_point() + xlab("Budburst to Leaf Out") +
ylab("Species") +geom_errorbarh(aes(xmin=Budburst-sd, xmax=Budburst+sd, col="coral"), height=.0) +
geom_errorbarh(aes(xmin=Leaves-sd.leaf, xmax=Leaves+sd.leaf, col="forestgreen"), height=.0)
plot(ts.timeline)
y$code <- reorder(y$species, y$DOY)
ts<-ggplot((y), aes(x=code, y=DOY)) + geom_point(aes(col=Phenophase)) +
xlab("Day of Year") + ylab("Species") + geom_errorbar(aes(ymin=DOY-sd, ymax=DOY+sd, col=Phenophase), width=.0) +
scale_x_discrete(labels = c("POPDEL","FRAAME", "MALSPP", "PRUSER","ACERUB", "BETALL", "BETPAP", "FAGGRA",
"QUERUB", "BETNIG", "QUEALB", "ULMAME", "ACESAC", "POPTRE"))
plot(ts)
View(basic)
basic<-na.omit(basic)
ts.timeline<-ggplot((basic), aes(x=Budburst, y=code), stat="identity") + geom_point(aes(x= basic$Budburst)) +
geom_segment(aes(y = species, yend = species, x = Budburst, xend = Leaves)) +
geom_point(aes(x=basic$Leaves)) + theme(legend.position="none") + geom_point() + xlab("Budburst to Leaf Out") +
ylab("Species") +geom_errorbarh(aes(xmin=Budburst-sd, xmax=Budburst+sd, col="coral"), height=.0) +
geom_errorbarh(aes(xmin=Leaves-sd.leaf, xmax=Leaves+sd.leaf, col="forestgreen"), height=.0)
plot(ts.timeline)
View(y)
View(df)
lm16<-lmer(Risk~Budburst + Latitude + (1|species), data=df)
display(lm16)
coef(lm16)
lm16.2<-lmer(Risk~Budburst + Latitude + Budburst:Latitude + (1|species), data=df)
display(lm16); display(lm16.2)
lm16<-lmer(Risk~Budburst + Latitude + (1|species), data=df)
display(lm16)
hist(coef(lm16)$species[,1],)
coef(lm16)$species[,1]
ranef(lm16)$species[,1]
lm14<-lmer(Risk~Budburst + Latitude + (1|species), data=df14)
fourteen<-read.csv("input/NPN_2014.csv",header=TRUE)
six<-read.csv("input/NPN_2010.csv",header=TRUE)
ten<-read.csv("input/NPN_2010.csv",header=TRUE)
pheno14<-fourteen%>%
dplyr::select(Site_ID, Genus, Species, Individual_ID, Phenophase_Description, First_Yes_DOY, First_Yes_Year, Latitude, Longitude, NumYs_in_Series) %>%
unite(species, Genus, Species, sep="_") %>%
filter(Phenophase_Description %in% phases) %>%
rename(Year = First_Yes_Year) %>%
filter(NumYs_in_Series>1)
df14<-pheno14%>%
dplyr::select(-NumYs_in_Series) %>%
group_by(species, Individual_ID, Phenophase_Description)%>%
arrange(Individual_ID) %>%
filter(row_number()==1) %>%
spread(Phenophase_Description, First_Yes_DOY)
df14<-na.omit(df14)
df14$Risk <- df14$Leaves - df14$Budburst
df14<-filter(df14, Risk > 0)
df14<-ungroup(df14)
df14$mean<-ave(df14$Budburst, df14$species)
df14$sd<-ave(df14$Budburst, df14$species, FUN=sd)
df14$mean.leaf<-ave(df14$Leaves, df14$species)
df14$sd.leaf<-ave(df14$Leaves, df14$species, FUN=sd)
y14<- df14 %>%
dplyr::select(species, Budburst, Leaves, Risk, mean, sd, mean.leaf, sd.leaf) %>%
gather(Phenophase, DOY, -species, -Risk, -mean, -sd, -mean.leaf, -sd.leaf)
y14<-y14 %>%
group_by(species, mean, Phenophase)%>%
arrange(species)%>%
filter(row_number()==1)%>%
ungroup(y14)
bud14<- df14 %>%
dplyr::select(species, Budburst) %>%
group_by(species)%>%
summarise_each(funs(mean), Budburst) %>%
arrange(species)
leaves14<- df14 %>%
dplyr::select(species, Leaves) %>%
group_by(species)%>%
summarise_each(funs(mean), Leaves) %>%
arrange(species)
sd14<- df14 %>%
dplyr::select(species, sd, sd.leaf)
basic14<- full_join(bud14, leaves14)
basic14<-full_join(basic14, sd14)
basic14$Risk<- basic14$Leaves - basic14$Budburst
basic14$code <- reorder(basic14$species, basic14$Budburst)
basic14<-na.omit(basic14)
ts.timeline14<-ggplot((basic14), aes(x=Budburst, y=code), stat="identity") + geom_point() +
geom_segment(aes(y = species, yend = species, x = Budburst, xend = Leaves)) +
geom_point(aes(x=basic14$Leaves)) + theme(legend.position="none") + geom_point() + xlab("Budburst to Leaf Out") +
ylab("Species") + geom_errorbarh(aes(xmin=Budburst-sd, xmax=Budburst+sd, col="coral"), height=.0) +
geom_errorbarh(aes(xmin=Leaves-sd.leaf, xmax=Leaves+sd.leaf, col="forestgreen"), height=.0)
plot(ts.timeline14)
y14$code <- reorder(y14$species, y14$DOY)
ts14<-ggplot((y14), aes(x=code, y=DOY)) + geom_point(aes(col=Phenophase)) +
xlab("Day of Year") + ylab("Species") + geom_errorbar(aes(ymin=DOY-sd, ymax=DOY+sd, col=Phenophase), width=.0)
plot(ts14)
lm14<-lmer(Risk~Budburst + Latitude + (1|species), data=df14)
display(lm14)
########## 2010 ##############
pheno10<-ten%>%
dplyr::select(Site_ID, Genus, Species, Individual_ID, Phenophase_Description, First_Yes_DOY, First_Yes_Year, Latitude, Longitude, NumYs_in_Series) %>%
unite(species, Genus, Species, sep="_") %>%
filter(Phenophase_Description %in% phases) %>%
rename(Year = First_Yes_Year) %>%
filter(NumYs_in_Series>1)
df10<-pheno10%>%
dplyr::select(-NumYs_in_Series)%>%
group_by(species, Individual_ID, Phenophase_Description)%>%
arrange(Individual_ID) %>%
filter(row_number()==1) %>%
spread(Phenophase_Description, First_Yes_DOY)
df10<-na.omit(df10)
df10$Risk <- df10$Leaves - df10$Budburst
df10<-filter(df10, Risk > 0)
df10<-ungroup(df10)
df10$mean<-ave(df10$Budburst, df10$species)
df10$sd<-ave(df10$Budburst, df10$species, FUN=sd)
df10$mean.leaf<-ave(df10$Leaves, df10$species)
df10$sd.leaf<-ave(df10$Leaves, df10$species, FUN=sd)
y10<- df10 %>%
dplyr::select(species, Budburst, Leaves, Risk, mean, sd, mean.leaf, sd.leaf) %>%
gather(Phenophase, DOY, -species, -Risk, -mean, -sd, -mean.leaf, -sd.leaf)
y10<-y10 %>%
group_by(species, mean, Phenophase)%>%
arrange(species)%>%
filter(row_number()==1)%>%
ungroup(y10)
bud10<- df10 %>%
dplyr::select(species, Budburst) %>%
group_by(species)%>%
summarise_each(funs(mean), Budburst) %>%
arrange(species)
leaves10<- df10 %>%
dplyr::select(species, Leaves) %>%
group_by(species)%>%
summarise_each(funs(mean), Leaves) %>%
arrange(species)
sd10<- y10 %>%
dplyr::select(species, sd, sd.leaf)
basic10<- full_join(bud10, leaves10)
basic10$Risk<- basic10$Leaves - basic10$Budburst
basic10<-full_join(basic10, sd10)
basic10$code <- reorder(basic10$species, basic10$Budburst)
basic10<-na.omit(basic10)
ts.timeline<-ggplot((basic10), aes(x=Budburst, y=code), stat="identity") + geom_point(aes(x= basic10$Budburst)) +
geom_segment(aes(y = species, yend = species, x = Budburst, xend = Leaves)) +
geom_point(aes(x=basic10$Leaves)) + theme(legend.position="none") + geom_point() + xlab("Budburst to Leaf Out") +
ylab("Species") +geom_errorbarh(aes(xmin=Budburst-sd, xmax=Budburst+sd, col="coral"), height=.0) +
geom_errorbarh(aes(xmin=Leaves-sd.leaf, xmax=Leaves+sd.leaf, col="forestgreen"), height=.0)
plot(ts.timeline)
y10$code <- reorder(y10$species, y10$DOY)
ts<-ggplot((y10), aes(x=code, y=DOY)) + geom_point(aes(col=Phenophase)) +
xlab("Day of Year") + ylab("Species") + geom_errorbar(aes(ymin=DOY-sd, ymax=DOY+sd, col=Phenophase), width=.0) #+
#scale_x_discrete(labels = c("POPDEL","FRAAME", "MALSPP", "PRUSER","ACERUB", "BETALL", "BETPAP", "FAGGRA",
#"QUERUB", "BETNIG", "QUEALB", "ULMAME", "ACESAC", "POPTRE"))
plot(ts)
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(arm)
library(data.table)
# Set Working Directory
setwd("~/Documents/git/springfreeze")
sixteen<-read.csv("input/NPN_2016.csv",header=TRUE)
fourteen<-read.csv("input/NPN_2014.csv",header=TRUE)
ten<-read.csv("input/NPN_2010.csv",header=TRUE)
phases<-c("Budburst","Leaves")
pheno16<-sixteen%>%
dplyr::select(Site_ID, Genus, Species, Individual_ID, Phenophase_Description, First_Yes_DOY, First_Yes_Year, Latitude, Longitude, NumYs_in_Series) %>%
unite(species, Genus, Species, sep="_") %>%
filter(Phenophase_Description %in% phases) %>%
rename(Year = First_Yes_Year) %>%
filter(NumYs_in_Series>1)
df<-pheno16%>%
dplyr::select(-NumYs_in_Series)%>%
group_by(species, Individual_ID, Phenophase_Description)%>%
arrange(Individual_ID) %>%
filter(row_number()==1) %>%
spread(Phenophase_Description, First_Yes_DOY)
df<-na.omit(df)
df$Risk <- df$Leaves - df$Budburst
df<-filter(df, Risk > 0)
df<-ungroup(df)
df$mean<-ave(df$Budburst, df$species)
df$sd<-ave(df$Budburst, df$species, FUN=sd)
df$mean.leaf<-ave(df$Leaves, df$species)
df$sd.leaf<-ave(df$Leaves, df$species, FUN=sd)
y<- df %>%
dplyr::select(species, Budburst, Leaves, Risk, mean, sd, mean.leaf, sd.leaf) %>%
gather(Phenophase, DOY, -species, -Risk, -mean, -sd, -mean.leaf, -sd.leaf)
y<-y %>%
group_by(species, mean, Phenophase)%>%
arrange(species)%>%
filter(row_number()==1)%>%
ungroup(y)
bud<- df %>%
dplyr::select(species, Budburst) %>%
group_by(species)%>%
summarise_each(funs(mean), Budburst) %>%
arrange(species)
leaves<- df %>%
dplyr::select(species, Leaves) %>%
group_by(species)%>%
summarise_each(funs(mean), Leaves) %>%
arrange(species)
sd<- y %>%
dplyr::select(species, sd, sd.leaf)
basic<- full_join(bud, leaves)
basic$Risk<- basic$Leaves - basic$Budburst
basic<-full_join(basic, sd)
basic$code <- reorder(basic$species, basic$Budburst)
basic<-na.omit(basic)
ts.timeline<-ggplot((basic), aes(x=Budburst, y=code), stat="identity") + geom_point(aes(x= basic$Budburst)) +
geom_segment(aes(y = species, yend = species, x = Budburst, xend = Leaves)) +
geom_point(aes(x=basic$Leaves)) + theme(legend.position="none") + geom_point() + xlab("Budburst to Leaf Out") +
ylab("Species") +geom_errorbarh(aes(xmin=Budburst-sd, xmax=Budburst+sd, col="coral"), height=.0) +
geom_errorbarh(aes(xmin=Leaves-sd.leaf, xmax=Leaves+sd.leaf, col="forestgreen"), height=.0)
plot(ts.timeline)
y$code <- reorder(y$species, y$DOY)
ts<-ggplot((y), aes(x=code, y=DOY)) + geom_point(aes(col=Phenophase)) +
xlab("Day of Year") + ylab("Species") + geom_errorbar(aes(ymin=DOY-sd, ymax=DOY+sd, col=Phenophase), width=.0) #+
#scale_x_discrete(labels = c("POPDEL","FRAAME", "MALSPP", "PRUSER","ACERUB", "BETALL", "BETPAP", "FAGGRA",
#"QUERUB", "BETNIG", "QUEALB", "ULMAME", "ACESAC", "POPTRE"))
plot(ts)
# Analysis 2016
hist(coef(lm16)$species[,1],)
lm16<-lmer(Risk~Budburst + Latitude + (1|species), data=df)
display(lm16)
coef(lm16)$species[,1]
ranef(lm16)$species[,1]
ts<-ggplot((y), aes(x=code, y=DOY)) + geom_point(aes(col=Phenophase)) +
xlab("Day of Year") + ylab("Species") + geom_errorbar(aes(ymin=DOY-sd, ymax=DOY+sd, col=Phenophase), width=.0) +
scale_x_discrete(labels = add_newlines(test.data$text, 20), name = "")
ts<-ggplot((y), aes(x=code, y=DOY)) + geom_point(aes(col=Phenophase)) +
xlab("Day of Year") + ylab("Species") + geom_errorbar(aes(ymin=DOY-sd, ymax=DOY+sd, col=Phenophase), width=.0)
+ scale_x_discrete(labels = abbreviate)
ts<-ggplot((y), aes(x=code, y=DOY)) + geom_point(aes(col=Phenophase)) +
xlab("Day of Year") + ylab("Species") + geom_errorbar(aes(ymin=DOY-sd, ymax=DOY+sd, col=Phenophase), width=.0) +
scale_x_discrete(labels = abbreviate)
plot(ts)
View(y)
y<-na.omit(y)
ts<-ggplot((y), aes(x=code, y=DOY)) + geom_point(aes(col=Phenophase)) +
xlab("Day of Year") + ylab("Species") + geom_errorbar(aes(ymin=DOY-sd, ymax=DOY+sd, col=Phenophase), width=.0) +
scale_x_discrete(labels = abbreviate)
plot(ts)
y<- df %>%
dplyr::select(species, Budburst, Leaves, Risk, mean, sd, mean.leaf, sd.leaf) %>%
gather(Phenophase, DOY, -species, -Risk, -mean, -sd, -mean.leaf, -sd.leaf)
y<-y %>%
group_by(species, mean, Phenophase)%>%
arrange(species)%>%
filter(row_number()==1)%>%
ungroup(y)
y$code <- reorder(y$species, y$DOY)
y$sd<-ifelse(y$sd=0, NA, y$sd)
y$sd<-ifelse(y$sd==0, NA, y$sd)
y<-na.omit(y)
ts<-ggplot((y), aes(x=code, y=DOY)) + geom_point(aes(col=Phenophase)) +
xlab("Day of Year") + ylab("Species") + geom_errorbar(aes(ymin=DOY-sd, ymax=DOY+sd, col=Phenophase), width=.0) +
scale_x_discrete(labels = abbreviate)
plot(ts)
pheno16<-sixteen%>%
dplyr::select(Site_ID, Genus, Species, Individual_ID, Phenophase_Description, First_Yes_DOY, First_Yes_Year, Latitude, Longitude, NumYs_in_Series) %>%
unite(species, Genus, Species, sep="_") %>%
filter(Phenophase_Description %in% phases) %>%
filter(Latitude>35 & Latitude<50)%>%
rename(Year = First_Yes_Year) %>%
filter(NumYs_in_Series>1)
df<-pheno16%>%
dplyr::select(-NumYs_in_Series)%>%
group_by(species, Individual_ID, Phenophase_Description)%>%
arrange(Individual_ID) %>%
filter(row_number()==1) %>%
spread(Phenophase_Description, First_Yes_DOY)
df<-na.omit(df)
df$Risk <- df$Leaves - df$Budburst
df<-filter(df, Risk > 0)
df<-ungroup(df)
df$mean<-ave(df$Budburst, df$species)
df$sd<-ave(df$Budburst, df$species, FUN=sd)
df$mean.leaf<-ave(df$Leaves, df$species)
df$sd.leaf<-ave(df$Leaves, df$species, FUN=sd)
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(arm)
library(data.table)
# Set Working Directory
setwd("~/Documents/git/springfreeze")
sixteen<-read.csv("input/NPN_2016.csv",header=TRUE)
fourteen<-read.csv("input/NPN_2014.csv",header=TRUE)
ten<-read.csv("input/NPN_2010.csv",header=TRUE)
phases<-c("Budburst","Leaves")
pheno16<-sixteen%>%
dplyr::select(Site_ID, Genus, Species, Individual_ID, Phenophase_Description, First_Yes_DOY, First_Yes_Year, Latitude, Longitude, NumYs_in_Series) %>%
unite(species, Genus, Species, sep="_") %>%
filter(Phenophase_Description %in% phases) %>%
filter(Latitude>35 & Latitude<50)%>%
rename(Year = First_Yes_Year) %>%
filter(NumYs_in_Series>1)
df<-pheno16%>%
dplyr::select(-NumYs_in_Series)%>%
group_by(species, Individual_ID, Phenophase_Description)%>%
arrange(Individual_ID) %>%
filter(row_number()==1) %>%
spread(Phenophase_Description, First_Yes_DOY)
df<-na.omit(df)
df$Risk <- df$Leaves - df$Budburst
df<-filter(df, Risk > 0)
df<-ungroup(df)
df$mean<-ave(df$Budburst, df$species)
df$stand_dev<-ave(df$Budburst, df$species, FUN=sd)
df$mean.leaf<-ave(df$Leaves, df$species)
df$stand_dev.leaf<-ave(df$Leaves, df$species, FUN=sd)
y<- df %>%
dplyr::select(species, Budburst, Leaves, Risk, mean, stand_dev, mean.leaf, stand_dev.leaf) %>%
gather(Phenophase, DOY, -species, -Risk, -mean, -stand_dev, -mean.leaf, -stand_dev.leaf)
y<-y %>%
group_by(species, mean, Phenophase)%>%
arrange(species)%>%
filter(row_number()==1)%>%
ungroup(y)
bud<- df %>%
dplyr::select(species, Budburst) %>%
group_by(species)%>%
summarise_each(funs(mean), Budburst) %>%
arrange(species)
leaves<- df %>%
dplyr::select(species, Leaves) %>%
group_by(species)%>%
summarise_each(funs(mean), Leaves) %>%
arrange(species)
stand_dev<- y %>%
dplyr::select(species, stand_dev, stand_dev.leaf)
basic<- full_join(bud, leaves)
basic$Risk<- basic$Leaves - basic$Budburst
basic<-full_join(basic, stand_dev)
basic$code <- reorder(basic$species, basic$Budburst)
basic<-na.omit(basic)
ts.timeline<-ggplot((basic), aes(x=Budburst, y=code), stat="identity") + geom_point(aes(x= basic$Budburst)) +
geom_segment(aes(y = species, yend = species, x = Budburst, xend = Leaves)) +
geom_point(aes(x=basic$Leaves)) + theme(legend.position="none") + geom_point() + xlab("Budburst to Leaf Out") +
ylab("Species") +geom_errorbarh(aes(xmin=Budburst-stand_dev, xmax=Budburst+stand_dev, col="coral"), height=.0) +
geom_errorbarh(aes(xmin=Leaves-stand_dev.leaf, xmax=Leaves+stand_dev.leaf, col="forestgreen"), height=.0)
plot(ts.timeline)
y$code <- reorder(y$species, y$DOY)
y$stand_dev<-ifelse(y$stand_dev==0, NA, y$stand_dev)
y<-na.omit(y)
ts<-ggplot((y), aes(x=code, y=DOY)) + geom_point(aes(col=Phenophase)) +
xlab("Day of Year") + ylab("Species") + geom_errorbar(aes(ymin=DOY-stand_dev, ymax=DOY+stand_dev, col=Phenophase), width=.0) +
scale_x_discrete(labels = abbreviate)
#scale_x_discrete(labels = c("POPDEL","FRAAME", "MALSPP", "PRUSER","ACERUB", "BETALL", "BETPAP", "FAGGRA",
#"QUERUB", "BETNIG", "QUEALB", "ULMAME", "ACESAC", "POPTRE"))
plot(ts)
pheno16<-sixteen%>%
dplyr::select(Site_ID, Genus, Species, Individual_ID, Phenophase_Description, First_Yes_DOY, First_Yes_Year, Latitude, Longitude, NumYs_in_Series) %>%
unite(species, Genus, Species, sep="_") %>%
filter(Phenophase_Description %in% phases) %>%
filter(Latitude>40 & Latitude<50)%>%
rename(Year = First_Yes_Year) %>%
filter(NumYs_in_Series>1)
df<-pheno16%>%
dplyr::select(-NumYs_in_Series)%>%
group_by(species, Individual_ID, Phenophase_Description)%>%
arrange(Individual_ID) %>%
filter(row_number()==1) %>%
spread(Phenophase_Description, First_Yes_DOY)
df<-na.omit(df)
df$Risk <- df$Leaves - df$Budburst
df<-filter(df, Risk > 0)
df<-ungroup(df)
df$mean<-ave(df$Budburst, df$species)
df$stand_dev<-ave(df$Budburst, df$species, FUN=sd)
df$mean.leaf<-ave(df$Leaves, df$species)
df$stand_dev.leaf<-ave(df$Leaves, df$species, FUN=sd)
y<- df %>%
dplyr::select(species, Budburst, Leaves, Risk, mean, stand_dev, mean.leaf, stand_dev.leaf) %>%
gather(Phenophase, DOY, -species, -Risk, -mean, -stand_dev, -mean.leaf, -stand_dev.leaf)
y<-y %>%
group_by(species, mean, Phenophase)%>%
arrange(species)%>%
filter(row_number()==1)%>%
ungroup(y)
bud<- df %>%
dplyr::select(species, Budburst) %>%
group_by(species)%>%
summarise_each(funs(mean), Budburst) %>%
arrange(species)
leaves<- df %>%
dplyr::select(species, Leaves) %>%
group_by(species)%>%
summarise_each(funs(mean), Leaves) %>%
arrange(species)
stand_dev<- y %>%
dplyr::select(species, stand_dev, stand_dev.leaf)
basic<- full_join(bud, leaves)
basic$Risk<- basic$Leaves - basic$Budburst
basic<-full_join(basic, stand_dev)
basic$code <- reorder(basic$species, basic$Budburst)
basic<-na.omit(basic)
ts.timeline<-ggplot((basic), aes(x=Budburst, y=code), stat="identity") + geom_point(aes(x= basic$Budburst)) +
geom_segment(aes(y = species, yend = species, x = Budburst, xend = Leaves)) +
geom_point(aes(x=basic$Leaves)) + theme(legend.position="none") + geom_point() + xlab("Budburst to Leaf Out") +
ylab("Species") +geom_errorbarh(aes(xmin=Budburst-stand_dev, xmax=Budburst+stand_dev, col="coral"), height=.0) +
geom_errorbarh(aes(xmin=Leaves-stand_dev.leaf, xmax=Leaves+stand_dev.leaf, col="forestgreen"), height=.0)
plot(ts.timeline)
y$code <- reorder(y$species, y$DOY)
y$stand_dev<-ifelse(y$stand_dev==0, NA, y$stand_dev)
y<-na.omit(y)
ts<-ggplot((y), aes(x=code, y=DOY)) + geom_point(aes(col=Phenophase)) +
xlab("Day of Year") + ylab("Species") + geom_errorbar(aes(ymin=DOY-stand_dev, ymax=DOY+stand_dev, col=Phenophase), width=.0) +
scale_x_discrete(labels = abbreviate)
#scale_x_discrete(labels = c("POPDEL","FRAAME", "MALSPP", "PRUSER","ACERUB", "BETALL", "BETPAP", "FAGGRA",
#"QUERUB", "BETNIG", "QUEALB", "ULMAME", "ACESAC", "POPTRE"))
plot(ts)
View(df)
View(y)
lm16<-lmer(Risk~Budburst + Latitude + (1|species), data=df)
display(lm16)
pheno16<-sixteen%>%
dplyr::select(Site_ID, Genus, Species, Individual_ID, Phenophase_Description, First_Yes_DOY, First_Yes_Year, Latitude, Longitude, NumYs_in_Series) %>%
unite(species, Genus, Species, sep="_") %>%
filter(Phenophase_Description %in% phases) %>%
filter(Latitude>35 & Latitude<50)%>%
rename(Year = First_Yes_Year) %>%
filter(NumYs_in_Series>1)
df<-pheno16%>%
dplyr::select(-NumYs_in_Series)%>%
group_by(species, Individual_ID, Phenophase_Description)%>%
arrange(Individual_ID) %>%
filter(row_number()==1) %>%
spread(Phenophase_Description, First_Yes_DOY)
df<-na.omit(df)
df$Risk <- df$Leaves - df$Budburst
df<-filter(df, Risk > 0)
df<-ungroup(df)
df$mean<-ave(df$Budburst, df$species)
df$stand_dev<-ave(df$Budburst, df$species, FUN=sd)
df$mean.leaf<-ave(df$Leaves, df$species)
df$stand_dev.leaf<-ave(df$Leaves, df$species, FUN=sd)
y<- df %>%
dplyr::select(species, Budburst, Leaves, Risk, mean, stand_dev, mean.leaf, stand_dev.leaf) %>%
gather(Phenophase, DOY, -species, -Risk, -mean, -stand_dev, -mean.leaf, -stand_dev.leaf)
y<-y %>%
group_by(species, mean, Phenophase)%>%
arrange(species)%>%
filter(row_number()==1)%>%
ungroup(y)
bud<- df %>%
dplyr::select(species, Budburst) %>%
group_by(species)%>%
summarise_each(funs(mean), Budburst) %>%
arrange(species)
leaves<- df %>%
dplyr::select(species, Leaves) %>%
group_by(species)%>%
summarise_each(funs(mean), Leaves) %>%
arrange(species)
stand_dev<- y %>%
dplyr::select(species, stand_dev, stand_dev.leaf)
basic<- full_join(bud, leaves)
basic$Risk<- basic$Leaves - basic$Budburst
basic<-full_join(basic, stand_dev)
basic$code <- reorder(basic$species, basic$Budburst)
basic<-na.omit(basic)
ts.timeline<-ggplot((basic), aes(x=Budburst, y=code), stat="identity") + geom_point(aes(x= basic$Budburst)) +
geom_segment(aes(y = species, yend = species, x = Budburst, xend = Leaves)) +
geom_point(aes(x=basic$Leaves)) + theme(legend.position="none") + geom_point() + xlab("Budburst to Leaf Out") +
ylab("Species") +geom_errorbarh(aes(xmin=Budburst-stand_dev, xmax=Budburst+stand_dev, col="coral"), height=.0) +
geom_errorbarh(aes(xmin=Leaves-stand_dev.leaf, xmax=Leaves+stand_dev.leaf, col="forestgreen"), height=.0)
plot(ts.timeline)
y$code <- reorder(y$species, y$DOY)
y$stand_dev<-ifelse(y$stand_dev==0, NA, y$stand_dev)
y<-na.omit(y)
ts<-ggplot((y), aes(x=code, y=DOY)) + geom_point(aes(col=Phenophase)) +
xlab("Day of Year") + ylab("Species") + geom_errorbar(aes(ymin=DOY-stand_dev, ymax=DOY+stand_dev, col=Phenophase), width=.0) +
scale_x_discrete(labels = abbreviate)
#scale_x_discrete(labels = c("POPDEL","FRAAME", "MALSPP", "PRUSER","ACERUB", "BETALL", "BETPAP", "FAGGRA",
#"QUERUB", "BETNIG", "QUEALB", "ULMAME", "ACESAC", "POPTRE"))
plot(ts)
# Analysis 2016
hist(coef(lm16)$species[,1],)
lm16<-lmer(Risk~Budburst + Latitude + (1|species), data=df)
display(lm16)
