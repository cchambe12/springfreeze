## Downloaded USNPN Data to Establish Timeline from Bud Burst
## to Leaf Out for various Deciduous Broadleaf species around the US
## 12 October 2016 - Cat
# The core aim of this script is to establish a timeline for last spring freeze risk
# Clear workspace
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
# Set Working Directory
setwd("~/Documents/git/springfreeze")
phenology<-read.csv("input/individual_phenometrics_data.csv",header=TRUE, sep=",")
attach(phenology)
phases<-c("Budburst","Leaves")
pheno<-phenology%>%
select(Genus, Species, Individual_ID, Phenophase_Description, First_Yes_DOY, First_Yes_Year, Latitude, Longitude)%>%
unite(species, Genus, Species, sep="_") %>%
filter(Phenophase_Description %in% phases) %>%
rename(Year = First_Yes_Year)
spp<-as.data.frame(table(phenology$species))
d<-pheno%>%
filter(Year=="2010")%>%
group_by(species, Individual_ID, Phenophase_Description)%>%
arrange(Individual_ID) %>%
filter(row_number()==1) %>%
spread(Phenophase_Description, First_Yes_DOY)
d<-na.omit(d)
d$Risk <- d$Leaves - d$Budburst
d<-filter(d, Risk > 0)
d<-filter(d, Risk < 200)
sp<-as.data.frame(table(d$species))
df<- d %>%
select(species, Risk) %>%
group_by(species) %>%
summarise_each(funs(mean), Risk) %>%
arrange(species)
ggplot(df,aes(x=species,y=Risk, fill=factor(species))) +
geom_bar(stat = "identity" , position="dodge") +
xlab("Species")+ylab("Level of Risk")
genus<- full_join(phenology, d)
genus<-na.omit(genus)
genus$Risk <- genus$Leaves - genus$Budburst
genus<-filter(genus, Risk > 0)
genus<-filter(genus, Risk < 200)
gen.dat<- genus %>%
select(Genus, species, Risk, Individual_ID) %>%
group_by(species, Risk, Individual_ID)%>%
filter(row_number()==1)
gen<- gen.dat%>%
select(Genus, Risk) %>%
group_by(Genus) %>%
summarise_each(funs(mean), Risk)%>%
arrange(Genus)
ggplot(gen,aes(x=Genus,y=Risk, fill=factor(Genus))) +
geom_bar(stat = "identity" , position="dodge") +
xlab("Genus")+ylab("Level of Risk")
View(d)
View(df)
ggplot(df,aes(x=species,y=Risk, fill=factor(species))) +
geom_bar(stat = "identity" , position="dodge") +
xlab("Species")+ylab("Level of Risk")
bb<- d %>%
select(Genus, species, Budburst, Leaves) %>%
group_by(Genus) %>%
summarise_each(funs(mean), Budburst) %>%
arrange(Genus)
bb<- d %>%
select(Genus, Budburst, Leaves) %>%
group_by(Genus) %>%
summarise_each(funs(mean), Budburst) %>%
arrange(Genus)
bb<- d %>%
select(Genus, Budburst, Leaves) %>%
summarise_each(funs(mean), Budburst) %>%
arrange(Genus)
bb<- pheno %>%
select(Genus, Budburst, Leaves) %>%
summarise_each(funs(mean), Budburst) %>%
arrange(Genus)
d<-pheno%>%
filter(Year=="2010")%>%
group_by(Genus, species, Individual_ID, Phenophase_Description)%>%
arrange(Individual_ID) %>%
filter(row_number()==1) %>%
spread(Phenophase_Description, First_Yes_DOY)
View(pheno)
View(genus)
bb<- genus %>%
select(Genus, Budburst, Leaves) %>%
summarise_each(funs(mean), Budburst) %>%
arrange(Genus)
bb<- genus %>%
select(Genus, Budburst, Leaves) %>%
group_by(Genus)
summarise_each(funs(mean), Budburst) %>%
arrange(Genus)
View(genus)
bb<- genus %>%
select(Genus, species, Budburst, Leaves) %>%
group_by(Genus)
summarise_each(funs(mean), Budburst) %>%
arrange(Genus)
bb<- genus %>%
select(Genus, species, Budburst, Leaves)
View(bb)
bb<- genus %>%
select(Genus, Individual_ID, species, Budburst, Leaves)
View(bb)
bb<- genus %>%
select(Genus, Individual_ID, species, Budburst, Leaves)
group_by(Individual_ID)%>%
filter(row_number()==1)
bb<- genus %>%
select(Genus, Individual_ID, species, Budburst, Leaves)
group_by(Genus, Individual_ID)%>%
filter(row_number()==1)
bb<- genus %>%
select(Genus, Individual_ID, species, Budburst, Leaves) %>%
group_by(Genus, Individual_ID)%>%
filter(row_number()==1)
View(bb)
bb<- genus %>%
select(Genus, Individual_ID, species, Budburst, Leaves) %>%
group_by(Genus, Individual_ID)%>%
filter(row_number()==1) %>%
select(Genus, Budburst, Leaves) %>%
summarise_each(funs(mean), Budburst) %>%
)
bb<- genus %>%
select(Genus, Individual_ID, species, Budburst, Leaves) %>%
group_by(Genus, Individual_ID)%>%
filter(row_number()==1) %>%
select(Genus, Budburst, Leaves) %>%
summarise_each(funs(mean), Budburst) %>%
summarise_each(funs(mean), Leaves) %>%
arrange(Genus)
bb<- genus %>%
select(Genus, Individual_ID, species, Budburst, Leaves) %>%
group_by(Genus, Individual_ID)%>%
filter(row_number()==1) %>%
select(Genus, Budburst, Leaves) %>%
summarise_each(funs(mean), Budburst) %>%
arrange(Genus)
View(bb)
bb<- timeline %>%
select(Genus, Budburst) %>%
group_by(Genus) %>%
summarise_each(funs(mean), Budburst) %>%
arrange(Genus)
timeline<- genus %>%
select(Genus, Individual_ID, species, Budburst, Leaves) %>%
group_by(Genus, Individual_ID)%>%
filter(row_number()==1)
bb<- timeline %>%
select(Genus, Budburst) %>%
group_by(Genus) %>%
summarise_each(funs(mean), Budburst) %>%
arrange(Genus)
View(timeline)
View(bb)
View(gen.dat)
View(gen)
leaf<- timeline %>%
select(Genus, Leaves) %>%
group_by(Genus) %>%
summarise_each(funs(mean), Leaves) %>%
arrange(Genus)
map<-full_join(bb,leaf)
View(map)
plot<-ggplot(map,aes(x=,y=0))
plot<-plot+geom_segment(aes(y=0,x=Budburst,xend=Leaves))
plot<-ggplot(map,aes(x=,y=0))
plot+geom_segment(aes(y=0,x=Budburst,xend=Leaves))
plot<-ggplot(map,aes(x=,y=0))
plot+geom_segment(aes(y=0,x=Budburst,xend=Leaves, yend=y))
plot<-ggplot(map,aes(x=,y=0))
plot+geom_segment(aes(y=0,x=Budburst,xend=Leaves, yend=0))
plot+geom_segment(aes(y=0,x=Budburst,xend=Leaves, yend=0, fill=factor(Genus)))
time<-ggplot(map,aes(x=,y=0))
time+geom_segment(aes(y=0,x=Budburst,xend=Leaves, yend=0, fill=factor(Genus)))
time+geom_segment(aes(y=0,x=Budburst,xend=Leaves, yend=0)) + geom_jitter()
time+geom_segment(aes(y=0,x=Budburst,xend=Leaves, yend=0)) + geom_jitter(aes(x))
time+geom_segment(aes(y=0,x=Budburst,xend=Leaves, yend=0)) + geom_jitter(aes(time))
time+geom_segment(aes(y=0,x=Budburst,xend=Leaves, yend=0)) + geom_jitter(aes(Budburst, Leaves))
time+geom_segment(aes(y=0,x=Budburst,xend=Leaves, yend=0)) + geom_jitter(aes(Budburst))
install.packages("timevis")
library(timevis)
bb.leaf <- map(
id      = 1:28,
content = Genus,
start   = Budburst,
end     = Leaves
)
bb.leaf <- data.frame(
data    = map,
id      = 1:28,
content = Genus,
start   = Budburst,
end     = Leaves
)
bb.leaf <- data.frame(
data    = map,
id      = 1:28,
content = Genus,
start   = map$Budburst,
end     = map$Leaves
)
bb.leaf <- data.frame(
data    = map,
content = Genus,
start   = map$Budburst,
end     = map$Leaves
)
timevis(data=map, start=map$Budburst, end=map$Leaves, content=map$Genus)
timevis(data=map, start=Budburst, end=Leaves, content=Genus)
buds<-c(map$Budburst)
leaf<-c(map$Leaves)
id<-c(map$Genus)
timevis(data=map, start=buds, end=leaf, content=id)
buds<-list(map$Budburst)
buds<-list(map$Budburst)
leaf<-list(map$Leaves)
id<-list(map$Genus)
timevis(data=map, start=c(buds), end=c(leaf), content=c(id))
timevis(data=map, start=c(list(map$Budburst)), end=c(list(map$Leaves)), content=c(list(map$Genus)))
timevis(map)
timevis(data=map, start=(list(map$Budburst)), end=(list(map$Leaves)), content=(list(map$Genus)))
timevis(data=map, start=c(96.626, 111.6, 107.647, 114.47826,94.1818),
end=c(103.878,124.2,117.2353,123.217,102.8182),
content=c("Acer","Alnus","Amelanchier","Betula","Carya"))
timevis(data= data.frame( start=c(96.626, 111.6, 107.647, 114.47826,94.1818),
end=c(103.878,124.2,117.2353,123.217,102.8182),
content=c("Acer","Alnus","Amelanchier","Betula","Carya")))
time+geom_segment(x=Budburst,xend=Leaves,y=0,yend=2,color=aes(Genus),size=1)
time<-ggplot(map,aes(x=,y=0))
time+geom_segment(x=Budburst,xend=Leaves,y=0,yend=2,color=aes(Genus),size=1)
time+geom_segment(aes(y=0,x=Budburst,xend=Leaves, yend=0)) + geom_jitter(aes(Budburst))
time+geom_segment(aes(y=0,x=Budburst,xend=Leaves, yend=0), color=aes(Genus))
