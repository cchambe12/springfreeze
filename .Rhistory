dx<- d %>%
dplyr::select(ind, treatcode, lday, bday, site) %>%
filter(treatcode %in% tx)
## Omit Viburnum due to budburst date issues
dx<-na.omit(dx)
dx$species<-substr(dx$ind, 1, 6)
dx<-dx%>%filter(species!="VIBCAS")%>%filter(species!="VIBLAN") # all entries for two species have the same budburst and leafout day, removed because probably from error
small.spp<-dx %>% dplyr::select(species, treatcode) %>% filter(treatcode=="WL1")
spp<-unique(small.spp$species)
dx<-dx%>% filter(species %in% spp)
dx<-dplyr::select(dx, -ind, -site)
### Start determining risk for each treatment
dxx$risk<-dx$lday-dx$bday
dxx$dvr<-ave(dx$risk, dx$species, dx$treatcode)
dxx$dvr.sd<-ave(dx$risk, dx$species, dx$treatcode, FUN=sd)
dxx<-dplyr::select(dx, species, treatcode, dvr, dvr.sd)
dxx<-dxx[!duplicated(dxx),]
dxx$tx.sd<-paste(dxx$treatcode, "sd", sep="_")
dm<-dxx%>%dplyr::select(species, treatcode, dvr)%>%spread(treatcode, dvr)
ds<-dxx%>%dplyr::select(species, tx.sd, dvr.sd)%>%spread(tx.sd, dvr.sd)
dxx<-inner_join(dm, ds)
dxx$diff<-dxx$CS0-dxx$WL1
dxx$diff.sd<-sqrt((dxx$CS0_sd)^2+(dxx$WL1_sd)^2)
View(dx)
df<-dx%>%filter(treatcode=="WL1")%>%dplyr::select(treatcode, bday, species)
df$bday<-ave(df$bday, df$species, df$treatcode)
View(df)
df<-df[!duplicated(df),]
View(df)
df$code<-reorder(df$bday,df$species)
df$code<-reorder(df$species, df$species)
class(df$bday)
df$code<-reorder(df$species, df$bday)
dxx$code<-df$code
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) + ylab("Difference in DVR between Treatments") + xlab("Species")
diff
dx<- d %>%
dplyr::select(ind, treatcode, lday, bday, site) %>%
filter(treatcode %in% tx)
## Omit Viburnum due to budburst date issues
dx<-na.omit(dx)
dx$species<-substr(dx$ind, 1, 6)
dx<-dx%>%filter(species!="VIBCAS")%>%filter(species!="VIBLAN") # all entries for two species have the same budburst and leafout day, removed because probably from error
small.spp<-dx %>% dplyr::select(species, treatcode) %>% filter(treatcode=="WL1")
spp<-unique(small.spp$species)
dx<-dx%>% filter(species %in% spp)
dx<-dplyr::select(dx, -ind, -site)
dx<- d %>%
dplyr::select(ind, treatcode, lday, bday, site) %>%
filter(treatcode %in% tx)
## Omit Viburnum due to budburst date issues
dx<-na.omit(dx)
dx$species<-substr(dx$ind, 1, 6)
dx<-dx%>%filter(species!="VIBCAS")%>%filter(species!="VIBLAN") # all entries for two species have the same budburst and leafout day, removed because probably from error
small.spp<-dx %>% dplyr::select(species, treatcode) %>% filter(treatcode=="WL1")
spp<-unique(small.spp$species)
dx<-dx%>% filter(species %in% spp)
dx$mean.bb<- ave(dx$bday, dx$species, dx$treatcode)
dx$sd.bb<- ave(dx$bday, dx$species, dx$treatcode, FUN=sd)
dx$mean.lo<-ave(dx$lday, dx$species, dx$treatcode)
dx$sd.lo<- ave(dx$lday, dx$species, dx$treatcode, FUN=sd)
dx<-dx%>%dplyr::select(species, treatcode, mean.bb, mean.lo, sd.bb, sd.lo)
dx<-dx[!duplicated(dx),]
dx$dvr<-dx$mean.lo-dx$mean.bb
#dx$code<-reorder(dx$species,dx$mean.bb)
dx$dvr.sd<-sqrt((dx$sd.bb)^2 + (dx$sd.lo)^2)
d.sub<-dplyr::select(dx, species, treatcode, dvr, dvr.sd)
d.sub$tx.sd<-paste(d.sub$treatcode, "sd", sep="_")
dm<-d.sub%>%dplyr::select(species, treatcode, dvr)%>%spread(treatcode, dvr)
ds<-d.sub%>%dplyr::select(species, tx.sd, dvr.sd)%>%spread(tx.sd, dvr.sd)
dxx<-inner_join(dm, ds)
dxx$diff<-dxx$CS0-dxx$WL1
dxx$diff.sd<-sqrt((dxx$CS0_sd)^2+(dxx$WL1_sd)^2)
#chill<-ggplot(dx, aes(x = code,ymin = mean.bb, ymax = mean.lo, group=interaction(species, treatcode) )) +
#geom_point(aes(y=mean.bb, col="forestgreen"), position = position_dodge(.5)) + geom_point(aes(y=mean.lo, col="darkgreen"), position = position_dodge(.5)) +
#geom_linerange(aes(x = code,ymin = mean.bb, ymax = mean.lo, col=treatcode), position=position_dodge(.5)) +  ylab("Day of Year") +
#scale_color_manual(labels = c("CS0","Leafout", "Budburst", "WL1"), values = c("purple3", "green4", "darkolivegreen3", "royalblue3")) +
#xlab("Species") +coord_flip()
#plot(chill)
dxx$code<-dx$code[!duplicated(dx$code)]
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) + ylab("Difference in DVR between Treatments") + xlab("Species")
diff
View(dxx)
dxx$code<-dx$code[!duplicated(dx$code)]
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) + ylab("Difference in DVR between Treatments") + xlab("Species")
diff
View(dxx)
dx<- d %>%
dplyr::select(ind, treatcode, lday, bday, site) %>%
filter(treatcode %in% tx)
## Omit Viburnum due to budburst date issues
dx<-na.omit(dx)
dx$species<-substr(dx$ind, 1, 6)
dx<-dx%>%filter(species!="VIBCAS")%>%filter(species!="VIBLAN") # all entries for two species have the same budburst and leafout day, removed because probably from error
small.spp<-dx %>% dplyr::select(species, treatcode) %>% filter(treatcode=="WL1")
spp<-unique(small.spp$species)
dx<-dx%>% filter(species %in% spp)
dx$mean.bb<- ave(dx$bday, dx$species, dx$treatcode)
dx$sd.bb<- ave(dx$bday, dx$species, dx$treatcode, FUN=sd)
dx$mean.lo<-ave(dx$lday, dx$species, dx$treatcode)
dx$sd.lo<- ave(dx$lday, dx$species, dx$treatcode, FUN=sd)
dx<-dx%>%dplyr::select(species, treatcode, mean.bb, mean.lo, sd.bb, sd.lo)
dx<-dx[!duplicated(dx),]
dx$dvr<-dx$mean.lo-dx$mean.bb
dx$code<-reorder(dx$species,dx$mean.bb)
dx$dvr.sd<-sqrt((dx$sd.bb)^2 + (dx$sd.lo)^2)
d.sub<-dplyr::select(dx, species, treatcode, dvr, dvr.sd)
d.sub$tx.sd<-paste(d.sub$treatcode, "sd", sep="_")
dm<-d.sub%>%dplyr::select(species, treatcode, dvr)%>%spread(treatcode, dvr)
ds<-d.sub%>%dplyr::select(species, tx.sd, dvr.sd)%>%spread(tx.sd, dvr.sd)
dxx<-inner_join(dm, ds)
dxx$diff<-dxx$CS0-dxx$WL1
dxx$diff.sd<-sqrt((dxx$CS0_sd)^2+(dxx$WL1_sd)^2)
#chill<-ggplot(dx, aes(x = code,ymin = mean.bb, ymax = mean.lo, group=interaction(species, treatcode) )) +
#geom_point(aes(y=mean.bb, col="forestgreen"), position = position_dodge(.5)) + geom_point(aes(y=mean.lo, col="darkgreen"), position = position_dodge(.5)) +
#geom_linerange(aes(x = code,ymin = mean.bb, ymax = mean.lo, col=treatcode), position=position_dodge(.5)) +  ylab("Day of Year") +
#scale_color_manual(labels = c("CS0","Leafout", "Budburst", "WL1"), values = c("purple3", "green4", "darkolivegreen3", "royalblue3")) +
#xlab("Species") +coord_flip()
#plot(chill)
dxx$code<-dx$code[!duplicated(dx$code)]
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) + ylab("Difference in DVR between Treatments") + xlab("Species")
diff
View(df)
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab("Difference in DVR between Treatments") + xlab("Species") + ylim(0,50)
plot(diff)
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab("Difference in DVR between Treatments") + xlab("Species") + coord_cartesian(ylim=c(0,50))
plot(diff)
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
# Set Working Directory
setwd("~/Documents/git/springfreeze")
d<-read.csv("input/Budburst.clean.csv",header=TRUE)
tx<-c("CS0", "WL1")
dx<- d %>%
dplyr::select(ind, treatcode, lday, bday, site) %>%
filter(treatcode %in% tx)
## Omit Viburnum due to budburst date issues
dx<-na.omit(dx)
dx$species<-substr(dx$ind, 1, 6)
dx<-dx%>%filter(species!="VIBCAS")%>%filter(species!="VIBLAN") # all entries for two species have the same budburst and leafout day, removed because probably from error
small.spp<-dx %>% dplyr::select(species, treatcode) %>% filter(treatcode=="WL1")
spp<-unique(small.spp$species)
dx<-dx%>% filter(species %in% spp)
dx<-dplyr::select(dx, -ind, -site)
### Start determining risk for each treatment
dxx$risk<-dx$lday-dx$bday
dxx$dvr<-ave(dx$risk, dx$species, dx$treatcode)
dxx$dvr.sd<-ave(dx$risk, dx$species, dx$treatcode, FUN=se)
dxx<-dplyr::select(dx, species, treatcode, dvr, dvr.sd)
dxx<-dxx[!duplicated(dxx),]
dxx$tx.sd<-paste(dxx$treatcode, "se", sep="_")
dm<-dxx%>%dplyr::select(species, treatcode, dvr)%>%spread(treatcode, dvr)
ds<-dxx%>%dplyr::select(species, tx.sd, dvr.sd)%>%spread(tx.sd, dvr.sd)
dxx<-inner_join(dm, ds)
dxx$diff<-dxx$CS0-dxx$WL1
dxx$diff.sd<-sqrt((dxx$CS0_sd)^2+(dxx$WL1_sd)^2)
df<-dx%>%filter(treatcode=="WL1")%>%dplyr::select(treatcode, bday, species)
df$bday<-ave(df$bday, df$species, df$treatcode)
df<-df[!duplicated(df),]
df$code<-reorder(df$species, df$bday)
dxx$code<-df$code
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab("Difference in DVR between Treatments") + xlab("Species") + coord_cartesian(ylim=c(0,50))
plot(diff)
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
# Set Working Directory
setwd("~/Documents/git/springfreeze")
d<-read.csv("input/Budburst.clean.csv",header=TRUE)
tx<-c("CS0", "WL1")
dx<- d %>%
dplyr::select(ind, treatcode, lday, bday, site) %>%
filter(treatcode %in% tx)
## Omit Viburnum due to budburst date issues
dx<-na.omit(dx)
dx$species<-substr(dx$ind, 1, 6)
dx<-dx%>%filter(species!="VIBCAS")%>%filter(species!="VIBLAN") # all entries for two species have the same budburst and leafout day, removed because probably from error
small.spp<-dx %>% dplyr::select(species, treatcode) %>% filter(treatcode=="WL1")
spp<-unique(small.spp$species)
dx<-dx%>% filter(species %in% spp)
dx<-dplyr::select(dx, -ind, -site)
### Start determining risk for each treatment
dxx<-dx
dxx$risk<-dxx$lday-dxx$bday
dxx$dvr<-ave(dxx$risk, dxx$species, dxx$treatcode)
dxx$dvr.sd<-ave(dxx$risk, dxx$species, dxx$treatcode, FUN=se)
dxx<-dplyr::select(dxx, species, treatcode, dvr, dvr.sd)
dxx<-dxx[!duplicated(dxx),]
dxx$tx.sd<-paste(dxx$treatcode, "se", sep="_")
dm<-dxx%>%dplyr::select(species, treatcode, dvr)%>%spread(treatcode, dvr)
ds<-dxx%>%dplyr::select(species, tx.sd, dvr.sd)%>%spread(tx.sd, dvr.sd)
dxx<-inner_join(dm, ds)
dxx$diff<-dxx$CS0-dxx$WL1
dxx$diff.sd<-sqrt((dxx$CS0_sd)^2+(dxx$WL1_sd)^2)
df<-dx%>%filter(treatcode=="WL1")%>%dplyr::select(treatcode, bday, species)
df$bday<-ave(df$bday, df$species, df$treatcode)
df<-df[!duplicated(df),]
df$code<-reorder(df$species, df$bday)
dxx$code<-df$code
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab("Difference in DVR between Treatments") + xlab("Species") + coord_cartesian(ylim=c(0,50))
plot(diff)
dxx$dvr.sd<- stderr(dxx$dvr, dxx$species, dxx$treatcode)
dxx$dvr.sd<- aggregate(dvr ~ species + treatcode, data = dxx,
FUN = function(x) (se = std.error(x)))
dxx$dvr.sd<- aggregate(dvr ~ species + treatcode, data = dxx,
FUN = function(x) (se = stderr(x)))
dxx$dvr.sd<- aggregate(dvr ~ species + treatcode, data = dxx,
FUN = function(x) (se = stderr(x)))
dxx$dvr.sd<- aggregate(dvr ~ species + treatcode, data = dxx,
FUN = function(x) {sd(x)/sqrt(length(x))})
dxx$dvr.sd<- aggregate(x=dvr, by=c(species, treatcode), data = dxx,
FUN = function(x) {sd(x)/sqrt(length(x))})
dxx$dvr.sd<- aggregate(dvr, by=c(species, treatcode), data = dxx,
FUN = function(x) {sd(x)/sqrt(length(x))})
dxx$dvr.sd<- aggregate(dxx$dvr, by=c(dxx$species, dxx$treatcode), data = dxx,
FUN = function(x) {sd(x)/sqrt(length(x))})
dxx$dvr.sd<- aggregate(dxx$dvr, by=list(dxx$species, dxx$treatcode), data = dxx,
FUN = function(x) {sd(x)/sqrt(length(x))})
dxx$dvr.sd<- aggregate(dxx$dvr, by=list(species, treatcode), data = dxx,
FUN = function(x) {sd(x)/sqrt(length(x))})
dxx$dvr.sd<- aggregate(dxx$dvr, by=list(dxx$species, dxx$treatcode), data = dxx,
FUN = function(x) {sd(x)/sqrt(length(x))})
x<-ave(dxx$risk, dxx$species, dxx$treatcode)
dxx$dvr.sd<-sd(x)/sqrt(length(x))
x<-group_by(dxx$species, dxx$treatcode)
x<-ave(dxx$risk, dxx$species, dxx$treatcode)
dxx$sp.tx<-paste(dxx$species, dxx$treatcode)
se<-vector()
for(i in length(unique(dxx$sp.tx))){
se[i]<-sd(x)/sqrt(length(x))
}
dxx$sp.tx<-paste(dxx$species, dxx$treatcode)
se<-vector()
for(i in length(unique(dxx$sp.tx))){
se[i]<-sd(dxx$dvr[i])/sqrt(length(dxx$dvr[i]))
}
test<-dplyr::select(dxx, dvr, species)
test<-test[!duplicated(test),]
View(test)
for(i in length(unique(dxx$sp.tx))){
se[i]<-ave(dxx$risk, dxx$species, dxx$treatcode, FUN=sd)/sqrt(length(dxx$dvr))
}
for(i in length(unique(dxx$sp.tx))){
se[i]<-ave(dxx$risk, dxx$species, dxx$treatcode, FUN=sd)/sqrt(length(dxx$dvr[i]))
}
length(dxx$sp.tx)
length(unique(dxx$sp.tx))
for(i in length(unique(dxx$sp.tx))){
se[i]<-ave(dxx$risk, dxx$species, dxx$treatcode, FUN=sd)/sqrt(length(unique(dxx$dvr)))
}
se<-ave(dxx$risk, dxx$species, dxx$treatcode, FUN=sd)/sqrt(length(unique(dxx$dvr)))
se
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
# Set Working Directory
setwd("~/Documents/git/springfreeze")
d<-read.csv("input/Budburst.clean.csv",header=TRUE)
tx<-c("CS0", "WL1")
dx<- d %>%
dplyr::select(ind, treatcode, lday, bday, site) %>%
filter(treatcode %in% tx)
## Omit Viburnum due to budburst date issues
dx<-na.omit(dx)
dx$species<-substr(dx$ind, 1, 6)
dx<-dx%>%filter(species!="VIBCAS")%>%filter(species!="VIBLAN") # all entries for two species have the same budburst and leafout day, removed because probably from error
small.spp<-dx %>% dplyr::select(species, treatcode) %>% filter(treatcode=="WL1")
spp<-unique(small.spp$species)
dx<-dx%>% filter(species %in% spp)
dx<-dplyr::select(dx, -ind, -site)
### Start determining risk for each treatment
dxx<-dx
dxx$risk<-dxx$lday-dxx$bday
dxx$dvr<-ave(dxx$risk, dxx$species, dxx$treatcode)
dxx$dvr.se<-ave(dxx$risk, dxx$species, dxx$treatcode, FUN=sd)/sqrt(length(unique(dxx$dvr)))
dxx<-dplyr::select(dxx, species, treatcode, dvr, dvr.sd)
dxx<-dxx[!duplicated(dxx),]
dxx$tx.sd<-paste(dxx$treatcode, "se", sep="_")
dm<-dxx%>%dplyr::select(species, treatcode, dvr)%>%spread(treatcode, dvr)
ds<-dxx%>%dplyr::select(species, tx.sd, dvr.sd)%>%spread(tx.sd, dvr.sd)
dxx<-inner_join(dm, ds)
dxx$diff<-dxx$CS0-dxx$WL1
dxx$diff.sd<-sqrt((dxx$CS0_sd)^2+(dxx$WL1_sd)^2)
df<-dx%>%filter(treatcode=="WL1")%>%dplyr::select(treatcode, bday, species)
df$bday<-ave(df$bday, df$species, df$treatcode)
df<-df[!duplicated(df),]
df$code<-reorder(df$species, df$bday)
dxx$code<-df$code
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab("Difference in DVR between Treatments") + xlab("Species") + coord_cartesian(ylim=c(0,50))
plot(diff)
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
# Set Working Directory
setwd("~/Documents/git/springfreeze")
d<-read.csv("input/Budburst.clean.csv",header=TRUE)
tx<-c("CS0", "WL1")
dx<- d %>%
dplyr::select(ind, treatcode, lday, bday, site) %>%
filter(treatcode %in% tx)
## Omit Viburnum due to budburst date issues
dx<-na.omit(dx)
dx$species<-substr(dx$ind, 1, 6)
dx<-dx%>%filter(species!="VIBCAS")%>%filter(species!="VIBLAN") # all entries for two species have the same budburst and leafout day, removed because probably from error
small.spp<-dx %>% dplyr::select(species, treatcode) %>% filter(treatcode=="WL1")
spp<-unique(small.spp$species)
dx<-dx%>% filter(species %in% spp)
dx<-dplyr::select(dx, -ind, -site)
### Start determining risk for each treatment
dxx<-dx
dxx$risk<-dxx$lday-dxx$bday
dxx$dvr<-ave(dxx$risk, dxx$species, dxx$treatcode)
dxx$dvr.sd<-ave(dxx$risk, dxx$species, dxx$treatcode, FUN=sd)/sqrt(length(unique(dxx$dvr)))
dxx<-dplyr::select(dxx, species, treatcode, dvr, dvr.sd)
dxx<-dxx[!duplicated(dxx),]
dxx$tx.sd<-paste(dxx$treatcode, "se", sep="_")
dm<-dxx%>%dplyr::select(species, treatcode, dvr)%>%spread(treatcode, dvr)
ds<-dxx%>%dplyr::select(species, tx.sd, dvr.sd)%>%spread(tx.sd, dvr.sd)
dxx<-inner_join(dm, ds)
dxx$diff<-dxx$CS0-dxx$WL1
dxx$diff.sd<-sqrt((dxx$CS0_sd)^2+(dxx$WL1_sd)^2)
df<-dx%>%filter(treatcode=="WL1")%>%dplyr::select(treatcode, bday, species)
df$bday<-ave(df$bday, df$species, df$treatcode)
df<-df[!duplicated(df),]
df$code<-reorder(df$species, df$bday)
dxx$code<-df$code
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab("Difference in DVR between Treatments") + xlab("Species") + coord_cartesian(ylim=c(0,50))
plot(diff)
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
# Set Working Directory
setwd("~/Documents/git/springfreeze")
d<-read.csv("input/Budburst.clean.csv",header=TRUE)
tx<-c("CS0", "WL1")
dx<- d %>%
dplyr::select(ind, treatcode, lday, bday, site) %>%
filter(treatcode %in% tx)
## Omit Viburnum due to budburst date issues
dx<-na.omit(dx)
dx$species<-substr(dx$ind, 1, 6)
dx<-dx%>%filter(species!="VIBCAS")%>%filter(species!="VIBLAN") # all entries for two species have the same budburst and leafout day, removed because probably from error
small.spp<-dx %>% dplyr::select(species, treatcode) %>% filter(treatcode=="WL1")
spp<-unique(small.spp$species)
dx<-dx%>% filter(species %in% spp)
dx<-dplyr::select(dx, -ind, -site)
### Start determining risk for each treatment
dxx<-dx
dxx$risk<-dxx$lday-dxx$bday
dxx$dvr<-ave(dxx$risk, dxx$species, dxx$treatcode)
dxx$dvr.sd<-ave(dxx$risk, dxx$species, dxx$treatcode, FUN=sd)/sqrt(length(unique(dxx$dvr)))
dxx<-dplyr::select(dxx, species, treatcode, dvr, dvr.sd)
dxx<-dxx[!duplicated(dxx),]
dxx$tx.sd<-paste(dxx$treatcode, "se", sep="_")
dm<-dxx%>%dplyr::select(species, treatcode, dvr)%>%spread(treatcode, dvr)
ds<-dxx%>%dplyr::select(species, tx.sd, dvr.sd)%>%spread(tx.sd, dvr.sd)
dxx<-inner_join(dm, ds)
dxx$diff<-dxx$CS0-dxx$WL1
dxx$diff.sd<-sqrt((dxx$CS0_se)^2+(dxx$WL1_se)^2)
df<-dx%>%filter(treatcode=="WL1")%>%dplyr::select(treatcode, bday, species)
df$bday<-ave(df$bday, df$species, df$treatcode)
df<-df[!duplicated(df),]
df$code<-reorder(df$species, df$bday)
dxx$code<-df$code
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab("Difference in DVR between Treatments") + xlab("Species") + coord_cartesian(ylim=c(0,50))
plot(diff)
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab("Difference in DVR between Treatments") + xlab("Species") + coord_cartesian(ylim=c(0,30))
plot(diff)
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab("Difference in DVR between Treatments") + xlab("Species") + coord_cartesian(ylim=c(0,25))
plot(diff)
ggplot(d, aes(x=study, y=reorder(temperature, sector))) +
geom_linerange(aes(ymin=temperature-sd, ymax=temperature+sd, color=sector), alpha=0.2) +
geom_point(aes(shape=phase, color=sector)) + coord_flip()
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(rstanarm)
library(shinystan)
library(bayesplot)
## Let's make the data...
d<- data.frame(study=c("Lenz2016: Sorbus aucuparia (50%)", "Lenz2016: Prunus avium (50%)", "Lenz2016: Tilia platyphyllos (50%)",
"Lenz2016: Acer pseudoplatanus (50%)", "Lenz2016: Fagus sylvatica (50%)", "Schwartz1993: All species (hard)",
"Augspurger2013: All species (soft)", "Barker2005: Eucalyptus pauciflora", "Peterson2014: All species",
"Cannell1986: All species", "Longstroth2012: Vaccinium spp.", "Longstroth2013: Rosaceae (10%)", "Longstroth2013: Rosaceae (90%)",
"Barlow2015: Wheat (10-90%)", "Barlow2015: Wheat (100%)", "Sanchez2013: Rice (100%)", "Sanchez2013: Corn (100%)", "Sanchez: Wheat (100%)"),
phase=c("Vegetative", "Vegetative", "Vegetative", "Vegetative", "Vegetative", "Both", "Both", "Both", "Both", "Both",
"Floral", "Vegetative", "Vegetative", "Floral", "Vegetative", "Vegetative", "Vegetative", "Vegetative"),
sector=c("Ecologicial", "Ecologicial", "Ecologicial", "Ecologicial", "Ecologicial", "Ecologicial",
"Ecologicial", "Ecologicial", "Ecologicial", "Agrinomic", "Agrinomic", "Agrinomic", "Agrinomic",
"Agrinomic", "Agrinomic", "Agrinomic", "Agrinomic", "Agrinomic"),
temperature=c(-7.4, -8.5, -7.4, -6.7, -4.8, -2.2, -1.7, -5.8, -2.2, 2, -2.2, -7.2, -13.3, -4.5,
-5.5, 4.7, -1.8, -17.2),
sd=c(4, 5, 3, 4, 3, 0, 0, 0, 0, 1, 2.2, 0, 0, 0.5, 1.5, 1.3, 1.9, 1.2))
ggplot(d, aes(x=study, y=reorder(temperature, sector))) +
geom_linerange(aes(ymin=temperature-sd, ymax=temperature+sd, color=sector), alpha=0.2) +
geom_point(aes(shape=phase, color=sector)) + coord_flip()
ggplot(d, aes(x=study, y=reorder(sector, temperature))) +
geom_linerange(aes(ymin=temperature-sd, ymax=temperature+sd, color=sector), alpha=0.2) +
geom_point(aes(shape=phase, color=sector)) + coord_flip()
ggplot(d, aes(x=reorder(study, sector), y=temperature)) +
geom_linerange(aes(ymin=temperature-sd, ymax=temperature+sd, color=sector), alpha=0.2) +
geom_point(aes(shape=phase, color=sector)) + coord_flip()
warnings()
d$set <- factor(d$study, levels = sector)
d$set <- factor(d$study, levels = d$sector)
d$study<-df$study[order(df$sector)]
d$study<-d$study[order(d$sector)]
View(d)
ggplot(d, aes(x=study, y=temperature)) +
geom_linerange(aes(ymin=temperature-sd, ymax=temperature+sd, color=sector), alpha=0.3) +
geom_point(aes(shape=phase, color=sector)) + coord_flip()
ggplot(d, aes(x=order(study, by=sector), y=temperature)) +
geom_linerange(aes(ymin=temperature-sd, ymax=temperature+sd, color=sector), alpha=0.3) +
geom_point(aes(shape=phase, color=sector)) + coord_flip()
d$alph<-ifelse(d$sector=="agrinomic", 1, 2)
View(d)
d$alph<-ifelse(d$sector=="Agrinomic", 1, 2)
d$set<-reorder(study, alph)
d$set<-reorder(d$study, d$alph)
View(d)
ggplot(d, aes(x=order(set, by=sector), y=temperature)) +
geom_linerange(aes(ymin=temperature-sd, ymax=temperature+sd, color=sector), alpha=0.3) +
geom_point(aes(shape=phase, color=sector)) + coord_flip()
ggplot(d, aes(x=set, y=temperature)) +
geom_linerange(aes(ymin=temperature-sd, ymax=temperature+sd, color=sector), alpha=0.3) +
geom_point(aes(shape=phase, color=sector)) + xlab("Temperature Threshold") +
ylab("Study, Taxonomic group, Freeze Definition") + coord_flip() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
ggplot(d, aes(x=set, y=temperature)) +
geom_linerange(aes(ymin=temperature-sd, ymax=temperature+sd, color=sector), alpha=0.3) +
geom_point(aes(shape=phase, color=sector)) + xlab("Temperature Threshold") +
ylab("Study, Taxonomic group, Freeze Definition") + coord_flip() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")) +
geom_vline(xintercept=0, linetype="dotted")
ggplot(d, aes(x=set, y=temperature)) +
geom_linerange(aes(ymin=temperature-sd, ymax=temperature+sd, color=sector), alpha=0.3) +
geom_point(aes(shape=phase, color=sector)) + xlab("Temperature Threshold") +
ylab("Study, Taxonomic group, Freeze Definition") + coord_flip() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")) +
geom_line(xintercept=0, linetype="dotted")
ggplot(d, aes(x=set, y=temperature)) +
geom_linerange(aes(ymin=temperature-sd, ymax=temperature+sd, color=sector), alpha=0.3) +
geom_point(aes(shape=phase, color=sector)) + xlab("Temperature Threshold") +
ylab("Study, Taxonomic group, Freeze Definition") +
geom_hline(yintercept=0, linetype=2) + coord_flip() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
d$set2<-reorder(d$set, d$temperature)
ggplot(d, aes(x=set2, y=temperature)) +
geom_linerange(aes(ymin=temperature-sd, ymax=temperature+sd, color=sector), alpha=0.3) +
geom_point(aes(shape=phase, color=sector)) + xlab("Temperature Threshold") +
ylab("Study, Taxonomic group, Freeze Definition") +
geom_hline(yintercept=0, linetype=2) + coord_flip() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
ggplot(d, aes(x=set, y=temperature)) +
geom_linerange(aes(ymin=temperature-sd, ymax=temperature+sd, color=sector), alpha=0.3) +
geom_point(aes(shape=phase, color=sector)) + xlab("Temperature Threshold") +
ylab("Study, Taxonomic group, Freeze Definition") +
geom_hline(yintercept=0, linetype=2) + coord_flip() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
