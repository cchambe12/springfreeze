ungroup(ren.count) %>%
dplyr::select(-count, -year)
ren1<-ren1%>% filter (! duplicated(biweekly))
ren1$site<-"France"
ren.count$site<-"France"
d<-full_join(gm, wash)
d<-full_join(d, nc2)
d<-full_join(d, ren1)
d<-full_join(d, maine)
df<-full_join(gm.count,wash.count)
df<-full_join(df, nc.count)
df<-full_join(df, ren.count)
df<-full_join(df, water.count)
limits <- aes(ymax = mean + stand_dev, ymin=mean - stand_dev)
d$biweekly<-ifelse(d$biweekly=="02_2", "Feb 15 - Feb 29", d$biweekly)
d$biweekly<-ifelse(d$biweekly=="03_1", "Mar 1 - Mar 14", d$biweekly)
d$biweekly<-ifelse(d$biweekly=="03_2", "Mar 15 - Mar 31", d$biweekly)
d$biweekly<-ifelse(d$biweekly=="04_1", "Apr 1 - Apr 14", d$biweekly)
d$biweekly<-ifelse(d$biweekly=="04_2", "Apr 15 - Apr 30", d$biweekly)
d$biweekly<-ifelse(d$biweekly=="05_1", "May 1 - May 14", d$biweekly)
d$biweekly<-ifelse(d$biweekly=="05_2", "May 15 - May 31", d$biweekly)
d$high<-as.numeric(as.character(d$high))
d$low<-as.numeric(as.character(d$low))
d$biweekly <- factor(d$biweekly, levels=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30","May 1 - May 14","May 15 - May 31"))
limitcolor<-c("lightgoldenrod", "lightgoldenrod", "lightgoldenrod","plum", "plum", "plum",
"lightblue", "lightblue", "lightblue", "lightblue",
"pink", "pink", "pink", "mediumaquamarine", "mediumaquamarine", "mediumaquamarine", "mediumaquamarine")
ggplot((d), aes(x=biweekly, y=mean, col=site)) + geom_point() + xlab("Two Week Period") + ylab("Average Number of days per two week period below -2.2C") +
geom_line(aes(x=biweekly, y=mean, col=site, group=site)) + geom_linerange(limits, col=limitcolor)
risk<-ggplot(d, aes(x=biweekly, y=mean, color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")))) +
geom_point() + xlab("") + ylab("Number of days below -2.2C per two week period") +
geom_line(aes(x=biweekly, y=mean,  color=factor(site, labels = c("France: April 5 - May 10", "Germany: March 31 - April 30", "Maine: April 10 - May 30",
"North Carolina: February 21 - April 4", "Washington: March 22 - April 30")), group=site)) +
geom_linerange(aes(ymax = d$high, ymin=d$low), stat="density", position=position_dodge(.2), alpha=0.3, size=2) + labs(color="Location and Day of Budburst Range") +
theme(panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), legend.position=c(0.88,0.91),
legend.key.size=unit(0.3, "cm"), plot.margin=unit(c(.2,.5,-.3,.5),"cm")) +
scale_x_discrete(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"))
## Make a dataframe:
x<- data.frame("Site"=c( "Rhone-Alps, FR", "Bavaria, GM", "ME, USA", "NC, USA","WA, USA"), "Earliest"=c( 90,90, 100, 50, 80),
"Early" = c( 100, 112, 115, 80,100), "Late" = c( 115, 127, 120, 90, 120), "Latest" = c( 120,140, 150, 100, 130))
fix<-x%>%
gather("time", "doy", Earliest, Early, Late, Latest) %>%
arrange(desc(Site))
fix$biweekly<-ifelse((fix$doy>=46 & fix$doy <=60), "Feb 15 - Feb 29", fix$doy)
fix$biweekly<-ifelse((fix$doy>=61 & fix$doy <=73), "Mar 1 - Mar 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=74 & fix$doy <=91), "Mar 15 - Mar 31", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=92 & fix$doy <=106), "Apr 1 - Apr 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=107 & fix$doy <=121), "Apr 15 - Apr 30", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=122 & fix$doy <=136), "May 1 - May 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=137 & fix$doy <=152), "May 15 - May 31", fix$biweekly)
fix$doy<-as.numeric(as.character(fix$doy))
fix$Site <- factor(fix$Site,levels=sort(unique(fix$Site),decreasing=TRUE))
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site, fill=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(55, 70, 85, 101, 116, 131, 146), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"), position="top") +
theme(legend.position=c(0.06,0.3), legend.key.size=unit(0.4, "cm"), aspect.ratio=0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), plot.margin=unit(c(-.2,.5,.2,.5),"cm")) +
ylab("") + xlab("")
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)))
risk<-ggplot(d, aes(x=biweekly, y=mean, color=factor(site, labels = c("Bavaria, Germany: March 31 - April 30", "Maine, USA: April 10 - May 30",
"North Carolina, USA: February 21 - April 4",  "Rhone-Alps, France: April 5 - May 10", "Washington: March 22 - April 30")))) +
geom_point() + xlab("") + ylab("Number of days below -2.2C per two week period") +
geom_line(aes(x=biweekly, y=mean,  color=factor(site, labels = c("Bavaria, Germany: March 31 - April 30", "Maine, USA: April 10 - May 30",
"North Carolina, USA: February 21 - April 4",  "Rhone-Alps, France: April 5 - May 10", "Washington: March 22 - April 30")), group=site)) +
geom_linerange(aes(ymax = d$high, ymin=d$low), stat="density", position=position_dodge(.2), alpha=0.3, size=2) + labs(color="Location and Day of Budburst Range") +
theme(panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), legend.position=c(0.88,0.91),
legend.key.size=unit(0.3, "cm"), plot.margin=unit(c(.2,.5,-.3,.5),"cm")) +
scale_x_discrete(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"))
## Make a dataframe:
x<- data.frame("Site"=c( "Rhone-Alps, FR", "Bavaria, GM", "ME, USA", "NC, USA","WA, USA"), "Earliest"=c( 90,90, 100, 50, 80),
"Early" = c( 100, 112, 115, 80,100), "Late" = c( 115, 127, 120, 90, 120), "Latest" = c( 120,140, 150, 100, 130))
fix<-x%>%
gather("time", "doy", Earliest, Early, Late, Latest) %>%
arrange(desc(Site))
fix$biweekly<-ifelse((fix$doy>=46 & fix$doy <=60), "Feb 15 - Feb 29", fix$doy)
fix$biweekly<-ifelse((fix$doy>=61 & fix$doy <=73), "Mar 1 - Mar 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=74 & fix$doy <=91), "Mar 15 - Mar 31", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=92 & fix$doy <=106), "Apr 1 - Apr 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=107 & fix$doy <=121), "Apr 15 - Apr 30", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=122 & fix$doy <=136), "May 1 - May 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=137 & fix$doy <=152), "May 15 - May 31", fix$biweekly)
fix$doy<-as.numeric(as.character(fix$doy))
fix$Site <- factor(fix$Site,levels=sort(unique(fix$Site),decreasing=TRUE))
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site, fill=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(55, 70, 85, 101, 116, 131, 146), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"), position="top") +
theme(legend.position="none",
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), plot.margin=unit(c(-.2,.5,.2,.5),"cm")) +
ylab("") + xlab("")
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)))
risk<-ggplot(d, aes(x=biweekly, y=mean, color=factor(site, labels = c("Bavaria, Germany: March 31 - April 30", "Maine, USA: April 10 - May 30",
"North Carolina, USA: February 21 - April 4",  "Rhone-Alps, France: April 5 - May 10", "Washington: March 22 - April 30")))) +
geom_point() + xlab("") + ylab("Number of days below -2.2C per two week period") +
geom_line(aes(x=biweekly, y=mean,  color=factor(site, labels = c("Bavaria, Germany: March 31 - April 30", "Maine, USA: April 10 - May 30",
"North Carolina, USA: February 21 - April 4",  "Rhone-Alps, France: April 5 - May 10", "Washington: March 22 - April 30")), group=site)) +
geom_linerange(aes(ymax = d$high, ymin=d$low), stat="density", position=position_dodge(.2), alpha=0.3, size=2) + labs(color="Location and Day of Budburst Range") +
theme(panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), legend.position=c(0.88,0.91),
legend.key.size=unit(0.3, "cm"), plot.margin=unit(c(.2,.5,-.3,.5),"cm")) +
scale_x_discrete(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"))
## Make a dataframe:
x<- data.frame("Site"=c( "Rhone-Alps, FR", "Bavaria, GM", "ME, USA", "NC, USA","WA, USA"), "Earliest"=c( 90,90, 100, 50, 80),
"Early" = c( 100, 112, 115, 80,100), "Late" = c( 115, 127, 120, 90, 120), "Latest" = c( 120,140, 150, 100, 130))
fix<-x%>%
gather("time", "doy", Earliest, Early, Late, Latest) %>%
arrange(desc(Site))
fix$biweekly<-ifelse((fix$doy>=46 & fix$doy <=60), "Feb 15 - Feb 29", fix$doy)
fix$biweekly<-ifelse((fix$doy>=61 & fix$doy <=73), "Mar 1 - Mar 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=74 & fix$doy <=91), "Mar 15 - Mar 31", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=92 & fix$doy <=106), "Apr 1 - Apr 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=107 & fix$doy <=121), "Apr 15 - Apr 30", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=122 & fix$doy <=136), "May 1 - May 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=137 & fix$doy <=152), "May 15 - May 31", fix$biweekly)
fix$doy<-as.numeric(as.character(fix$doy))
fix$Site <- factor(fix$Site,levels=sort(unique(fix$Site),decreasing=TRUE))
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site, fill=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(55, 70, 85, 101, 116, 131, 146), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"), position="top") +
theme(legend.position="none", aspect.ratio = 0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), plot.margin=unit(c(-.2,.5,.2,.5),"cm")) +
ylab("") + xlab("")
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)))
ggplot(data = df, aes(x=biweekly, y=count)) + geom_boxplot(aes(fill=site))
risk<-ggplot(d, aes(x=biweekly, y=mean, color=factor(site, labels = c("Rhone-Alps, France: April 5 - May 10", "Bavaria, Germany: March 31 - April 30", "Maine, USA: April 10 - May 30",
"North Carolina, USA: February 21 - April 4", "Washington: March 22 - April 30")))) +
geom_point() + xlab("") + ylab("Number of days below -2.2C per two week period") +
geom_line(aes(x=biweekly, y=mean,  color=factor(site, labels = c("Rhone-Alps, France: April 5 - May 10", "Bavaria, Germany: March 31 - April 30", "Maine, USA: April 10 - May 30",
"North Carolina, USA: February 21 - April 4", "Washington: March 22 - April 30")), group=site)) +
geom_linerange(aes(ymax = d$high, ymin=d$low), stat="density", position=position_dodge(.2), alpha=0.3, size=2) + labs(color="Location and Day of Budburst Range") +
theme(panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), legend.position=c(0.88,0.91),
legend.key.size=unit(0.3, "cm"), plot.margin=unit(c(.2,.5,-.3,.5),"cm")) +
scale_x_discrete(breaks=c(53, 66, 82, 98, 114, 128, 144), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"))
## Make a dataframe:
x<- data.frame("Site"=c( "Rhone-Alps, FR", "Bavaria, GM", "ME, USA", "NC, USA","WA, USA"), "Earliest"=c( 90,90, 100, 50, 80),
"Early" = c( 100, 112, 115, 80,100), "Late" = c( 115, 127, 120, 90, 120), "Latest" = c( 120,140, 150, 100, 130))
fix<-x%>%
gather("time", "doy", Earliest, Early, Late, Latest) %>%
arrange(desc(Site))
fix$biweekly<-ifelse((fix$doy>=46 & fix$doy <=60), "Feb 15 - Feb 29", fix$doy)
fix$biweekly<-ifelse((fix$doy>=61 & fix$doy <=73), "Mar 1 - Mar 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=74 & fix$doy <=91), "Mar 15 - Mar 31", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=92 & fix$doy <=106), "Apr 1 - Apr 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=107 & fix$doy <=121), "Apr 15 - Apr 30", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=122 & fix$doy <=136), "May 1 - May 14", fix$biweekly)
fix$biweekly<-ifelse((fix$doy>=137 & fix$doy <=152), "May 15 - May 31", fix$biweekly)
fix$doy<-as.numeric(as.character(fix$doy))
fix$Site <- factor(fix$Site,levels=sort(unique(fix$Site),decreasing=TRUE))
time<- ggplot((fix), aes(y=doy, x=Site, color=Site)) + geom_boxplot(aes(y=doy, x=Site, fill=Site), width=0.2) + coord_flip() +
scale_y_continuous(breaks=c(55, 70, 85, 101, 116, 131, 146), label=c("Feb 15 - Feb 29", "Mar 1 - Mar 14", "Mar 15 - Mar 31", "Apr 1 - Apr 14",
"Apr 15 - Apr 30", "May 1 - May 14", "May 15 - May 31"), position="top") +
theme(legend.position="none", aspect.ratio = 0.3,
panel.grid.major = element_line(size=0.1),panel.grid.minor = element_line(size=0.1), plot.margin=unit(c(-.2,.5,.2,.5),"cm")) +
ylab("") + xlab("")
grid.draw(rbind(ggplotGrob(risk), ggplotGrob(time)))
library(ggplot2)
library(gridExtra)
doy<- 75:150
ile<-data.frame(doy, phase=NA, risk=NA)
ile$phase<-ifelse(ile$doy==95, "BB", ile$phase)
ile$phase<-ifelse(ile$doy==100, "LO", ile$phase)
ile$risk<-ifelse(ile$doy>=96 & ile$doy<=99, 10, ile$risk)
ile$risk<-ifelse(ile$doy==95, 6.5, ile$risk)
ile$risk<-ifelse(ile$doy==100, 7, ile$risk)
ile$risk<-ifelse(ile$doy>=75 & ile$doy<=94, 3, ile$risk)
ile$risk<-ifelse(ile$doy>=101, 4, ile$risk)
write.csv(ile, file = "~/Documents/git/springfreeze/output/ilemuc.csv", row.names = FALSE)
bet<-data.frame(doy, phase=NA, risk=NA)
bet$phase<-ifelse(bet$doy==122, "BB", bet$phase)
bet$phase<-ifelse(bet$doy==142, "LO", bet$phase)
bet$risk<-ifelse(bet$doy>=124 & bet$doy<=140, 10, bet$risk)
bet$risk<-ifelse(bet$doy==123, 6.5, bet$risk)
bet$risk<-ifelse(bet$doy==141, 7, bet$risk)
bet$risk<-ifelse(bet$doy>=75 & bet$doy<=122, 3, bet$risk)
bet$risk<-ifelse(bet$doy>=142, 4, bet$risk)
write.csv(bet, file = "~/Documents/git/springfreeze/output/betall.csv", row.names = FALSE)
ilemuc<-ggplot(ile, aes(x=doy, y=risk)) + geom_line() + coord_cartesian(ylim=0:20) +
annotate("rect", xmin=82, xmax=97, ymin=1, ymax=6, alpha=0.1, color="red") +
xlab("Day of Year") + ylab("Frost Damage Risk") +
annotate("text", x = 140, y = 18, label = "Ilex mucronata", fontface = "italic") +
annotate("text", x = 90, y = 4, label = "False", fontface="bold") +
annotate("text", x = 90, y = 2, label = "Spring", fontface="bold") +
annotate("text", x = 97.5, y = 11, label = "DVR")
betall<-ggplot(bet, aes(x=doy, y=risk)) + geom_line() + coord_cartesian(ylim=0:20) +
annotate("rect", xmin=82, xmax=97, ymin=1, ymax=6, alpha=0.1, color="red") +
xlab("Day of Year") + ylab("Frost Damage Risk") +
annotate("text", x = 140, y = 18, label = "Betula alleghaniensis", fontface = "italic") +
annotate("text", x = 90, y = 4, label = "False", fontface="bold") +
annotate("text", x = 90, y = 2, label = "Spring", fontface="bold") +
annotate("text", x = 132, y = 11, label = "DVR")
grid.arrange(ilemuc, betall, ncol=1, nrow=2)
library(ggplot2)
library(gridExtra)
doy<- 75:150
ile<-data.frame(doy, phase=NA, risk=NA)
ile$phase<-ifelse(ile$doy==95, "BB", ile$phase)
ile$phase<-ifelse(ile$doy==100, "LO", ile$phase)
ile$risk<-ifelse(ile$doy>=96 & ile$doy<=99, 10, ile$risk)
ile$risk<-ifelse(ile$doy==95, 6.5, ile$risk)
ile$risk<-ifelse(ile$doy==100, 7, ile$risk)
ile$risk<-ifelse(ile$doy>=75 & ile$doy<=94, 3, ile$risk)
ile$risk<-ifelse(ile$doy>=101, 4, ile$risk)
write.csv(ile, file = "~/Documents/git/springfreeze/output/ilemuc.csv", row.names = FALSE)
bet<-data.frame(doy, phase=NA, risk=NA)
bet$phase<-ifelse(bet$doy==122, "BB", bet$phase)
bet$phase<-ifelse(bet$doy==142, "LO", bet$phase)
bet$risk<-ifelse(bet$doy>=124 & bet$doy<=140, 10, bet$risk)
bet$risk<-ifelse(bet$doy==123, 6.5, bet$risk)
bet$risk<-ifelse(bet$doy==141, 7, bet$risk)
bet$risk<-ifelse(bet$doy>=75 & bet$doy<=122, 3, bet$risk)
bet$risk<-ifelse(bet$doy>=142, 4, bet$risk)
write.csv(bet, file = "~/Documents/git/springfreeze/output/betall.csv", row.names = FALSE)
ilemuc<-ggplot(ile, aes(x=doy, y=risk)) + geom_line() + coord_cartesian(ylim=0:20) +
annotate("rect", xmin=82, xmax=97, ymin=1, ymax=6, alpha=0.1, color="red") +
xlab("Day of Year") + ylab("Frost Damage Risk") +
annotate("text", x = 140, y = 18, label = "Ilex mucronata", fontface = "italic") +
annotate("text", x = 90, y = 4, label = "False", fontface="bold") +
annotate("text", x = 90, y = 2, label = "Spring", fontface="bold") +
annotate("text", x = 97.5, y = 11, label = "DVR")
betall<-ggplot(bet, aes(x=doy, y=risk)) + geom_line() + coord_cartesian(ylim=0:20) +
annotate("rect", xmin=82, xmax=97, ymin=1, ymax=6, alpha=0.1, color="red") +
xlab("Day of Year") + ylab("Frost Damage Risk") +
annotate("text", x = 140, y = 18, label = "Betula alleghaniensis", fontface = "italic") +
annotate("text", x = 90, y = 4, label = "False", fontface="bold") +
annotate("text", x = 90, y = 2, label = "Spring", fontface="bold") +
annotate("text", x = 133, y = 11, label = "DVR")
grid.arrange(ilemuc, betall, ncol=1, nrow=2)
library(ggplot2)
library(gridExtra)
doy<- 75:150
ile<-data.frame(doy, phase=NA, risk=NA)
ile$phase<-ifelse(ile$doy==95, "BB", ile$phase)
ile$phase<-ifelse(ile$doy==100, "LO", ile$phase)
ile$risk<-ifelse(ile$doy>=96 & ile$doy<=99, 10, ile$risk)
ile$risk<-ifelse(ile$doy==95, 6.5, ile$risk)
ile$risk<-ifelse(ile$doy==100, 7, ile$risk)
ile$risk<-ifelse(ile$doy>=75 & ile$doy<=94, 3, ile$risk)
ile$risk<-ifelse(ile$doy>=101, 4, ile$risk)
write.csv(ile, file = "~/Documents/git/springfreeze/output/ilemuc.csv", row.names = FALSE)
bet<-data.frame(doy, phase=NA, risk=NA)
bet$phase<-ifelse(bet$doy==122, "BB", bet$phase)
bet$phase<-ifelse(bet$doy==142, "LO", bet$phase)
bet$risk<-ifelse(bet$doy>=124 & bet$doy<=140, 10, bet$risk)
bet$risk<-ifelse(bet$doy==123, 6.5, bet$risk)
bet$risk<-ifelse(bet$doy==141, 7, bet$risk)
bet$risk<-ifelse(bet$doy>=75 & bet$doy<=122, 3, bet$risk)
bet$risk<-ifelse(bet$doy>=142, 4, bet$risk)
write.csv(bet, file = "~/Documents/git/springfreeze/output/betall.csv", row.names = FALSE)
ilemuc<-ggplot(ile, aes(x=doy, y=risk)) + geom_line() + coord_cartesian(ylim=0:20) +
annotate("rect", xmin=82, xmax=97, ymin=1, ymax=6, alpha=0.1, color="red") +
xlab("Day of Year") + ylab("Frost Damage Risk") +
annotate("text", x = 140, y = 18, label = "Ilex mucronata", fontface = "italic") +
annotate("text", x = 90, y = 4, label = "False", fontface="bold") +
annotate("text", x = 90, y = 2, label = "Spring", fontface="bold") +
annotate("text", x = 97.5, y = 11, label = "DVR")
betall<-ggplot(bet, aes(x=doy, y=risk)) + geom_line() + coord_cartesian(ylim=0:20) +
annotate("rect", xmin=82, xmax=97, ymin=1, ymax=6, alpha=0.1, color="red") +
xlab("Day of Year") + ylab("Frost Damage Risk") +
annotate("text", x = 140, y = 18, label = "Betula alleghaniensis", fontface = "italic") +
annotate("text", x = 90, y = 4, label = "False", fontface="bold") +
annotate("text", x = 90, y = 2, label = "Spring", fontface="bold") +
annotate("text", x = 132.5, y = 11, label = "DVR")
grid.arrange(ilemuc, betall, ncol=1, nrow=2)
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
# Set Working Directory
setwd("~/Documents/git/springfreeze")
d<-read.csv("input/Budburst.clean.csv",header=TRUE)
tx<-c("CS0", "WL1")
dx<- d %>%
dplyr::select(ind, treatcode, lday, bday, site) %>%
filter(treatcode %in% tx)
## Omit Viburnum due to budburst date issues
dx<-na.omit(dx)
dx$species<-substr(dx$ind, 1, 6)
dx<-dx%>%filter(species!="VIBCAS")%>%filter(species!="VIBLAN") # all entries for two species have the same budburst and leafout day, removed because probably from error
small.spp<-dx %>% dplyr::select(species, treatcode) %>% filter(treatcode=="WL1")
spp<-unique(small.spp$species)
dx<-dx%>% filter(species %in% spp)
dx<-dplyr::select(dx, -ind, -site)
### Start determining risk for each treatment
dxx<-dx
dxx$risk<-dxx$lday-dxx$bday
dxx$dvr<-ave(dxx$risk, dxx$species, dxx$treatcode)
dxx$dvr.sd<-ave(dxx$risk, dxx$species, dxx$treatcode, FUN=sd)/sqrt(length(unique(dxx$dvr)))
dxx<-dplyr::select(dxx, species, treatcode, dvr, dvr.sd)
dxx<-dxx[!duplicated(dxx),]
dxx$tx.sd<-paste(dxx$treatcode, "se", sep="_")
dm<-dxx%>%dplyr::select(species, treatcode, dvr)%>%spread(treatcode, dvr)
ds<-dxx%>%dplyr::select(species, tx.sd, dvr.sd)%>%spread(tx.sd, dvr.sd)
dxx<-inner_join(dm, ds)
dxx$diff<-dxx$CS0-dxx$WL1
dxx$diff.sd<-sqrt((dxx$CS0_se)^2+(dxx$WL1_se)^2)
df<-dx%>%filter(treatcode=="WL1")%>%dplyr::select(treatcode, bday, species)
df$bday<-ave(df$bday, df$species, df$treatcode)
df<-df[!duplicated(df),]
df$code<-reorder(df$species, df$bday)
dxx$code<-df$code
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab("Difference in DVR between Treatments") + xlab("Species") + coord_cartesian(ylim=c(0,25)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), axis.title.x=element_blank())
plot(diff)
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab("Difference in DVR between Treatments") + xlab("Species") + coord_cartesian(ylim=c(0,25)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"), axis.title.x=element_blank())
plot(diff)
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab("Difference in DVR between Treatments") + xlab("Species") + coord_cartesian(ylim=c(0,25)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"), axis.title.x=element_blank()) +
theme_bw()
plot(diff)
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab("Difference in DVR between Treatments") + xlab("Species") + coord_cartesian(ylim=c(0,25)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"), axis.title.x=element_blank())
plot(diff)
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab(delta,"DVR in cold long vs. short cool treatments") + xlab("Species") + coord_cartesian(ylim=c(0,25)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"), axis.title.x=element_blank())
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab(expression(delta),"DVR in cold long vs. short cool treatments") + xlab("Species") + coord_cartesian(ylim=c(0,25)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"), axis.title.x=element_blank())
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab(paste(expression(delta),"DVR in cold long vs. short cool treatments")) + xlab("Species") + coord_cartesian(ylim=c(0,25)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"), axis.title.x=element_blank())
plot(diff)
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab(paste(expression(Delta),"DVR in cold long vs. short cool treatments")) + xlab("Species") + coord_cartesian(ylim=c(0,25)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"), axis.title.x=element_blank())
plot(diff)
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab(expression(Delta*"DVR in cold long vs. short cool treatments")) + xlab("Species") + coord_cartesian(ylim=c(0,25)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"), axis.title.x=element_blank())
plot(diff)
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab(expression(Delta*"DVR in cold long vs. short cool treatments")) + xlab("Species") + coord_cartesian(ylim=c(0,25)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"), axis.title.x=element_blank())
plot(diff)
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab(expression(Delta*" DVR in cold long vs. short cool treatments")) + xlab("Species") + coord_cartesian(ylim=c(0,25)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"), axis.title.x=element_blank())
plot(diff)
dxx$code<-ifelse(dxx$code=="ILEMUC", "I. mucronata", dxx$code)
dxx$code<-ifelse(dxx$code=="ACEPEN", "A. pensylvanicum", dxx$code)
dxx$code<-ifelse(dxx$code=="BETALL", "B. alleghaniensis", dxx$code)
dxx$code<-ifelse(dxx$code=="BETPAP", "B. papyrifera", dxx$code)
dxx$code<-ifelse(dxx$code=="ACERUB", "A. rubrum", dxx$code)
dxx$code<-ifelse(dxx$code=="POPGRA", "P. grandidentata", dxx$code)
dxx$code<-ifelse(dxx$code=="QUERUB", "Q. rubra", dxx$code)
dxx$code<-ifelse(dxx$code=="ACESAC", "A. saccharum", dxx$code)
dxx$code<-ifelse(dxx$code=="FAGGRA", "F. grandifolia", dxx$code)
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab(expression(Delta*" DVR in cold long vs. short cool treatments")) + coord_cartesian(ylim=c(0,25)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
axis.text.x = element_text(face = "italic"))
plot(diff)
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
# Set Working Directory
setwd("~/Documents/git/springfreeze")
d<-read.csv("input/Budburst.clean.csv",header=TRUE)
tx<-c("CS0", "WL1")
dx<- d %>%
dplyr::select(ind, treatcode, lday, bday, site) %>%
filter(treatcode %in% tx)
## Omit Viburnum due to budburst date issues
dx<-na.omit(dx)
dx$species<-substr(dx$ind, 1, 6)
dx<-dx%>%filter(species!="VIBCAS")%>%filter(species!="VIBLAN") # all entries for two species have the same budburst and leafout day, removed because probably from error
small.spp<-dx %>% dplyr::select(species, treatcode) %>% filter(treatcode=="WL1")
spp<-unique(small.spp$species)
dx<-dx%>% filter(species %in% spp)
dx<-dplyr::select(dx, -ind, -site)
### Start determining risk for each treatment
dxx<-dx
dxx$risk<-dxx$lday-dxx$bday
dxx$dvr<-ave(dxx$risk, dxx$species, dxx$treatcode)
dxx$dvr.sd<-ave(dxx$risk, dxx$species, dxx$treatcode, FUN=sd)/sqrt(length(unique(dxx$dvr)))
dxx<-dplyr::select(dxx, species, treatcode, dvr, dvr.sd)
dxx<-dxx[!duplicated(dxx),]
dxx$tx.sd<-paste(dxx$treatcode, "se", sep="_")
dm<-dxx%>%dplyr::select(species, treatcode, dvr)%>%spread(treatcode, dvr)
ds<-dxx%>%dplyr::select(species, tx.sd, dvr.sd)%>%spread(tx.sd, dvr.sd)
dxx<-inner_join(dm, ds)
dxx$diff<-dxx$CS0-dxx$WL1
dxx$diff.sd<-sqrt((dxx$CS0_se)^2+(dxx$WL1_se)^2)
df<-dx%>%filter(treatcode=="WL1")%>%dplyr::select(treatcode, bday, species)
df$bday<-ave(df$bday, df$species, df$treatcode)
df<-df[!duplicated(df),]
df$species<-ifelse(df$species=="ILEMUC", "I. mucronata", df$species)
df$species<-ifelse(df$species=="ACEPEN", "A. pensylvanicum", df$species)
df$species<-ifelse(df$species=="BETALL", "B. alleghaniensis", df$species)
df$species<-ifelse(df$species=="BETPAP", "B. papyrifera", df$species)
df$species<-ifelse(df$species=="ACERUB", "A. rubrum", df$species)
df$species<-ifelse(df$species=="POPGRA", "P. grandidentata", df$species)
df$species<-ifelse(df$species=="QUERUB", "Q. rubra", df$species)
df$species<-ifelse(df$species=="ACESAC", "A. saccharum", df$species)
df$species<-ifelse(df$species=="FAGGRA", "F. grandifolia", df$species)
df$code<-reorder(df$species, df$bday)
dxx$code<-df$code
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab(expression(Delta*" DVR in cold long vs. short cool treatments")) + coord_cartesian(ylim=c(0,25)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
axis.text.x = element_text(face = "italic"))
plot(diff)
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab(expression(Delta*" DVR in cold long vs. short cool treatments")) + coord_cartesian(ylim=c(0,25)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
axis.text.x = element_text(face = "italic")) + +
scale_x_discrete(labels = add_newlines(dxx$code, 20), name = "")
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab(expression(Delta*" DVR in cold long vs. short cool treatments")) + coord_cartesian(ylim=c(0,25)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
axis.text.x = element_text(face = "italic"))
plot(diff)
df$species<-ifelse(df$species=="ILEMUC", "I. mucronata", df$species)
df$species<-ifelse(df$species=="ACEPEN", "A. pensylvanicum", df$species)
df$species<-ifelse(df$species=="BETALL", "B.alleghaniensis", df$species)
df$species<-ifelse(df$species=="BETPAP", "B.papyrifera", df$species)
df$species<-ifelse(df$species=="ACERUB", "A.rubrum", df$species)
df$species<-ifelse(df$species=="POPGRA", "P.grandidentata", df$species)
df$species<-ifelse(df$species=="QUERUB", "Q.rubra", df$species)
df$species<-ifelse(df$species=="ACESAC", "A.saccharum", df$species)
df$species<-ifelse(df$species=="FAGGRA", "F.grandifolia", df$species)
df$code<-reorder(df$species, df$bday)
dxx$code<-df$code
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab(expression(Delta*" DVR in cold long vs. short cool treatments")) + coord_cartesian(ylim=c(0,25)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
axis.text.x = element_text(face = "italic"))
plot(diff)
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab(expression(Delta*" DVR in cold long vs. short cool treatments")) + coord_cartesian(ylim=c(0,25)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
axis.text.x = element_text(face = "italic"), axis.text=element_text(size=9))
plot(diff)
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab(expression(Delta*" DVR in cold long vs. short cool treatments")) + coord_cartesian(ylim=c(0,25)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
axis.text.x = element_text(face = "italic"), axis.text=element_text(size=6))
plot(diff)
diff<-ggplot(dxx, aes(x=factor(code), y=diff)) + geom_point() +
geom_linerange(aes(ymin=diff-diff.sd, ymax=diff+diff.sd), alpha=0.3) +
ylab(expression(Delta*" DVR in cold long vs. short cool treatments")) + coord_cartesian(ylim=c(0,25)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
axis.text.x = element_text(face = "italic"), axis.text=element_text(size=5))
plot(diff)
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
## Let's make the data...
d<- data.frame(study=c("Sorbus aucuparia - 50% (Lenz et al., 2016)", "Prunus avium - 50% (Lenz et al., 2016)", "Tilia platyphyllos - 50% (Lenz et al., 2016)",
"Acer pseudoplatanus - 50% (Lenz et al., 2016)", "Fagus sylvatica - 50% (Lenz et al., 2016)", "All species - hard freeze (Schwartz, 1993))",
"All species - soft freeze (Augspurger, 2013)", "Eucalyptus pauciflora (Barker et al., 2005)", "All species (Peterson & Abatzoglou, 2014)",
"All species (Cannell & Smith, 1986)", "Vaccinium spp. (Longstroth, 2012)", "Rosaceae - 10% (Longstroth, 2013)", "Rosaceae - 90% (Longstroth, 2013)",
"Wheat - 10 to 90% (Barlow et al., 2015)", "Wheat - 100% (Barlow et al., 2015)", "Rice - 100% (Sanchez et al., 2013)", "Corn - 100% (Sanchez et al., 2013)", "Wheat - 100% (Sanchez et al., 2013)"),
phase=c("Vegetative", "Vegetative", "Vegetative", "Vegetative", "Vegetative", "Both", "Both", "Both", "Both", "Both",
"Floral", "Vegetative", "Vegetative", "Floral", "Vegetative", "Vegetative", "Vegetative", "Vegetative"),
sector=c("Ecologicial", "Ecologicial", "Ecologicial", "Ecologicial", "Ecologicial", "Ecologicial",
"Ecologicial", "Ecologicial", "Ecologicial", "Agronomic", "Agronomic", "Agronomic", "Agronomic",
"Agronomic", "Agronomic", "Agronomic", "Agronomic", "Agronomic"),
temperature=c(-7.4, -8.5, -7.4, -6.7, -4.8, -2.2, -1.7, -5.8, -2.2, 2, -2.2, -7.2, -13.3, -4.5,
-5.5, 4.7, -1.8, -17.2),
sd=c(4, 5, 3, 4, 3, 0, 0, 0, 0, 1, 2.2, 0, 0, 0.5, 1.5, 1.3, 1.9, 1.2))
d$alph<-ifelse(d$sector=="Agronomic", 1, 2)
d$dataset<-reorder(d$study, d$alph)
d$dataset <- factor(d$dataset, levels = d$dataset[order(d$sector, d$temperature)])
my.xlab = expression(paste("Temperature Threshold ", degree,"C"))
ggplot(d, aes(x=dataset, y=temperature)) +
geom_linerange(aes(ymin=temperature-sd, ymax=temperature+sd, color=sector), alpha=0.3) +
geom_point(aes(shape=phase, color=sector)) + ylab(my.xlab) + theme(axis.title.y=element_blank()) +
geom_hline(yintercept=0, linetype=2) + coord_flip() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")) +
ylim(c(-20, 10))
